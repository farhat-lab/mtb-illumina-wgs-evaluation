(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[36],{2380:function(e,t,a){"use strict";var n=a(92);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(1)),c=(0,n(a(96)).default)(r.default.createElement("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"}),"Email");t.default=c},2537:function(e,t,a){"use strict";a.r(t);var n=a(88),r=a(104),c=a(87),l=a.n(c),s=a(91),u=a(82),o=a(149),i=a(1),b=a.n(i),m=a(129),p=a(2475),f=a(2435),h=a(51),E=a(995),g=a(2418),v=a(1076),d=a(2429),y=a(2434),j=a(2532),k=a(84),O=a(532),w=a(1106),x=a(2465),S=a(2466),L=a(2467),M=a(2468),T=a(2427),C=a(2380),R=a.n(C),_=a(751),z=a.n(_),A=a(1033),H=a.n(A);var N=function(e){var t=Object(i.useState)(null),a=Object(u.a)(t,2),n=a[0],r=a[1],c=Object(i.useState)(null),o=Object(u.a)(c,2),h=o[0],E=o[1],g=e.hub,v=g.url,d=g.longLabel,y=g.shortLabel;return Object(i.useEffect)((function(){function e(){return(e=Object(s.a)(l.a.mark((function e(){var t,a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=Object(m.openLocation)({uri:v}),e.next=4,a.readFile("utf8");case 4:t=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(0),E(b.a.createElement("span",null,b.a.createElement("strong",null,"Error retrieving hub")," ",e.t0.message," ",b.a.createElement("br",null),v)),e.abrupt("return");case 11:try{n=new w.HubFile(t),r(n)}catch(c){E(b.a.createElement("span",null,b.a.createElement("strong",null,"Could not parse genomes file:")," ",b.a.createElement("br",null),c.message," ",b.a.createElement("br",null),v))}case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[v]),h?b.a.createElement(x.a,null,b.a.createElement(L.a,null,b.a.createElement(f.a,{color:"error"},h))):n?b.a.createElement(x.a,null,b.a.createElement(M.a,{title:y}),b.a.createElement(L.a,null,b.a.createElement("div",{__dangerouslySetInnerHTML:H.a.sanitize(d)})),b.a.createElement(S.a,null,b.a.createElement(T.a,{href:"mailto:".concat(n.get("email")),rel:"noopener noreferrer",target:"_blank",color:"secondary"},b.a.createElement(R.a,null)),n.get("descriptionUrl")?b.a.createElement(T.a,{href:new URL(n.get("descriptionUrl"),new URL(v)).href,rel:"noopener noreferrer",target:"_blank"},b.a.createElement(z.a,{color:"secondary"})):null)):b.a.createElement(p.a,{variant:"query"})},U=a(2426),F=a(2417),I=a(2431),J=a(2550),q=Object(h.a)((function(e){return{formControl:{minWidth:192,marginLeft:e.spacing(2),marginRight:e.spacing(2)}}}));var P=function(e){var t=e.selectList,a=e.selectedItem,n=e.handleSelect,r=e.label,c=e.helpText,l=q();return b.a.createElement(E.a,{className:l.formControl},b.a.createElement(F.a,null,r),b.a.createElement(J.a,{value:a,onChange:n},t.map((function(e){var t,a;return e.name&&(t=e.name,a="".concat(e.name," (").concat(e.synonyms.join(" "),")")),b.a.createElement(I.a,{key:a||e,value:t||e},a||e)}))),b.a.createElement(U.a,null,a?"":c))};function B(e){var t=e.status;return b.a.createElement(b.a.Fragment,null,b.a.createElement(p.a,{variant:"query"}),b.a.createElement(f.a,null,t))}function D(e){return(0,e.children)(Object(o.a)(e,["children"]))}var V=Object(h.a)((function(e){return{hubList:{maxHeight:400,overflowY:"auto"},genomeSelector:{marginTop:e.spacing(1)}}}));t.default=function(e){var t=e.model,a=e.setModelReady,c=Object(i.useState)(null),o=Object(u.a)(c,2),p=o[0],h=o[1],w=Object(i.useState)(null),x=Object(u.a)(w,2),S=x[0],L=x[1],M=Object(i.useState)(""),T=Object(u.a)(M,2),C=T[0],R=T[1],_=Object(i.useState)(""),z=Object(u.a)(_,2),A=z[0],H=z[1],U=Object(i.useState)(new Map),F=Object(u.a)(U,2),I=F[0],J=F[1],q=Object(i.useState)(!1),W=Object(u.a)(q,2),G=W[0],Y=W[1],K=Object(i.useState)(""),Q=Object(u.a)(K,2),X=Q[0],Z=Q[1],$=V();function ee(e,t){return te.apply(this,arguments)}function te(){return(te=Object(s.a)(l.a.mark((function e(t,a){var n,c,s,u,o,i,b;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 10,n=a?new Map:new Map(I),c=Math.floor(I.size/10)+1,e.next=5,re("https://www.trackhubregistry.org/api/search",{page:c,entries_per_page:10},{body:JSON.stringify({assembly:A}),signal:t});case 5:if(!(s=e.sent)){e.next=38;break}u=Object(r.a)(s.items),e.prev=8,u.s();case 10:if((o=u.n()).done){e.next=28;break}if(!(i=o.value).hub.url.startsWith("ftp://")){e.next=16;break}i.error="JBrowse cannot add connections from FTP sources",e.next=25;break;case 16:return b=Object(m.openLocation)({uri:i.hub.url}),e.prev=17,e.next=20,b.stat();case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(17),i.error=e.t0.message;case 25:n.set(i.id,i);case 26:e.next=10;break;case 28:e.next=33;break;case 30:e.prev=30,e.t1=e.catch(8),u.e(e.t1);case 33:return e.prev=33,u.f(),e.finish(33);case 36:J(n),n.size===s.total_entries&&Y(!0);case 38:case"end":return e.stop()}}),e,null,[[8,30,33,36],[17,22]])})))).apply(this,arguments)}function ae(e){return ne.apply(this,arguments)}function ne(){return(ne=Object(s.a)(l.a.mark((function e(t){var a,n,r,c,s=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:{},n=s.length>2&&void 0!==s[2]?s[2]:{},c=Object.keys(a).map((function(e){return"".concat(e,"=").concat(a[e])})).join(";"),e.prev=3,e.next=6,fetch("".concat(t).concat(c?"?".concat(c):""),n);case 6:r=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),Object(k.isAbortException)(e.t0)||h(b.a.createElement("span",null,b.a.createElement("strong",null,"Network connection error.")," ",b.a.createElement("br",null),e.t0.message," ",b.a.createElement("br",null),t)),e.abrupt("return",null);case 13:if(r.ok){e.next=16;break}return h(b.a.createElement("span",null,b.a.createElement("strong",null,"Error connecting to the URL.")," ",b.a.createElement("br",null),r.status,": ",r.statusText," ",b.a.createElement("br",null),t)),e.abrupt("return",null);case 16:return e.abrupt("return",r.json());case 17:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function re(e){return ce.apply(this,arguments)}function ce(){return(ce=Object(s.a)(l.a.mark((function e(t){var a,r,c,s,u=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.length>1&&void 0!==u[1]?u[1]:{},r=u.length>2&&void 0!==u[2]?u[2]:{},s=Object.keys(a).map((function(e){return"".concat(e,"=").concat(a[e])})).join(";"),e.prev=3,e.next=6,fetch("".concat(t).concat(s?"?".concat(s):""),Object(n.a)(Object(n.a)({},r),{},{method:"POST"}));case 6:c=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),Object(k.isAbortException)(e.t0)||h(b.a.createElement("span",null,b.a.createElement("strong",null,"Network connection error.")," ",b.a.createElement("br",null),e.t0.message," ",b.a.createElement("br",null),t)),e.abrupt("return",null);case 13:if(c.ok){e.next=16;break}return h(b.a.createElement("span",null,b.a.createElement("strong",null,"Error connecting to the URL.")," ",b.a.createElement("br",null),c.status,": ",c.statusText," ",b.a.createElement("br",null),t)),e.abrupt("return",null);case 16:return e.abrupt("return",c.json());case 17:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}Object(i.useEffect)((function(){a(!!X)}),[X,a]),Object(i.useEffect)((function(){var e=new AbortController,t=e.signal;function a(){return(a=Object(s.a)(l.a.mark((function e(){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae("https://www.trackhubregistry.org/api/info/ping",void 0,{signal:t});case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return");case 5:if(1===a.ping){e.next=8;break}return h("Registry is not available"),e.abrupt("return");case 8:return e.next=10,ae("https://www.trackhubregistry.org/api/info/assemblies",void 0,{signal:t});case 10:(n=e.sent)&&L(n);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(){a.apply(this,arguments)}(),function(){e.abort()}}),[]),Object(i.useEffect)((function(){var e=new AbortController,t=e.signal;return p||(A&&!I.size?ee(t,!0):I.size&&!G&&ee(t)),function(){e.abort()}}));var le=[b.a.createElement(f.a,{key:"heading",variant:"h6"},"The Track Hub Registry")];if(p)return le.push(b.a.createElement(f.a,{key:"errorMessage",color:"error"},p)),b.a.createElement("div",null,le);if(!S)return le.push(b.a.createElement(B,{key:"queryStatus",status:"Connecting to registry..."})),b.a.createElement("div",null,le);var se=Object.keys(S).sort().filter((function(e){return e.toLowerCase().includes("sapiens")}));if(le.push(b.a.createElement(P,{key:"speciesSelect",selectList:se,selectedItem:C,handleSelect:function(e){R(e.target.value),H(""),J(new Map),Z(""),Y(!1)},label:"Species",helpText:"Select a species"})),C){var ue=S[C].filter((function(e){return!("GRCh37"===e.name&&"hg38"===e.synonyms[0])}));le.push(b.a.createElement(P,{key:"assemblySelect",selectList:ue,selectedItem:A,handleSelect:function(e){H(e.target.value),J(new Map),Z(""),Y(!1)},label:"Assembly",helpText:"Select an assembly"}))}return A&&(le.push(b.a.createElement("div",{key:"hubSelect"},b.a.createElement(E.a,null,b.a.createElement(g.a,null,"Hubs:"),b.a.createElement("div",{className:$.hubList},b.a.createElement(v.a,{value:X,onChange:function(e){var a=e.target.value;Z(a),t.target.name.set(I.get(a).hub.shortLabel),t.target.assemblyNames.set([A]),t.target.trackDbId.set(a)}},Array.from(I.values()).filter((function(e){return e.assembly.name===A||e.assembly.synonyms.includes(A)})).map((function(e){var t=e.error,a=e.id,n=e.hub,r=n.shortLabel,c=n.longLabel;return b.a.createElement(D,{key:a,value:a},(function(e){return b.a.createElement(d.a,{title:t||b.a.createElement(O.a,{html:c}),placement:"left",interactive:!0},b.a.createElement(y.a,Object.assign({key:a,value:a,label:b.a.createElement(O.a,{html:r}),disabled:Boolean(t),control:b.a.createElement(j.a,null)},e)))}))}))))))),G||le.push(b.a.createElement(B,{key:"hubStatus",status:"Retrieving hubs"}))),X&&le.push(b.a.createElement(N,{key:"hubDetails",hub:I.get(X).hub})),b.a.createElement(b.a.Fragment,null,le)}}}]);
//# sourceMappingURL=36.1f38ffe5.chunk.js.map