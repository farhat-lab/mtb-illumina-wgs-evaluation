(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[41],{2503:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return S}));var n=r(88),a=r(149),c=r(87),s=r.n(c),i=r(91),u=r(86),o=r(90),d=r(93),f=r(95),p=r(1086),b=r(1266),l=r.n(b),h=r(127),v=r(129),g=r(140),m=r(135),k=r(531),y=r(191),j=r(81),O=r(815),S=function(e){Object(d.a)(r,e);var t=Object(f.a)(r);function r(e){var n;Object(u.a)(this,r),(n=t.call(this,e)).bigbed=void 0,n.parser=void 0;var a=Object(j.readConfObject)(e,"bigBedLocation");return n.bigbed=new p.BigBed({filehandle:Object(v.openLocation)(a)}),n.parser=n.bigbed.getHeader().then((function(e){var t=e.autoSql;return new l.a({autoSql:t})})),n}return Object(o.a)(r,[{key:"getRefNames",value:function(){var e=Object(i.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Object,e.next=3,this.bigbed.getHeader();case 3:return e.t1=e.sent.refsByName,e.abrupt("return",e.t0.keys.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeader",value:function(){var e=Object(i.a)(s.a.mark((function e(t){var r,c,i,u,o,d,f,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bigbed.getHeader(t);case 2:return r=e.sent,c=r.version,i=r.fileType,e.next=7,this.parser;case 7:return u=e.sent,o=u.autoSql,d=o.fields,f=Object(a.a)(o,["fields"]),p=Object.fromEntries(d.map((function(e){return[e.name,e.comment]}))),e.abrupt("return",{version:c,fileType:i,autoSql:Object(n.a)({},f),fields:p});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"refIdToName",value:function(){var e=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bigbed.getHeader();case 2:if(e.t1=t,e.t0=e.sent.refsByNumber[e.t1],e.t0){e.next=6;break}e.t0={};case 6:return e.abrupt("return",e.t0.name);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFeatures",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.refName,c=e.start,u=e.end,o=r.signal;return Object(g.ObservableCreate)(function(){var e=Object(i.a)(s.a.mark((function e(r){var i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.parser;case 3:return i=e.sent,e.next=6,t.bigbed.getFeatureStream(a,c,u,{signal:o,basesPerSpan:u-c});case 6:e.sent.pipe(Object(k.a)(),Object(y.a)((function(e){var r=i.parseLine("".concat(a,"\t").concat(e.start,"\t").concat(e.end,"\t").concat(e.rest),{uniqueId:e.uniqueId}),c=r.blockCount,s=r.blockSizes,u=r.blockStarts,o=r.chromStarts;if(c){var d=o||u||[],f=s,p=e.start;r.subfeatures=[];for(var b=0;b<c;b+=1){var l=(d[b]||0)+p,h=l+(f[b]||0);r.subfeatures.push({uniqueId:"".concat(e.uniqueId,"-").concat(b),start:l,end:h,type:"block"})}}if(void 0===e.uniqueId)throw new Error("invalid bbi feature");delete r.chromStart,delete r.chromEnd,delete r.chrom;var v=new m.a({id:"".concat(t.id,"-").concat(e.uniqueId),data:Object(n.a)(Object(n.a)({},r),{},{start:e.start,end:e.end,refName:a})});return v.get("thickStart")&&v.get("blockCount")&&0!==v.get("strand")?Object(O.a)(v):v}))).subscribe(r),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),r.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),r.signal)}},{key:"freeResources",value:function(){}}]),r}(h.BaseFeatureDataAdapter)},815:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(135);function a(e){var t=e.children(),r=e.get("thickStart"),a=e.get("thickEnd");if(!r&&!a)return e;var c=t?t.filter((function(e){return"block"===e.get("type")})).sort((function(e,t){return e.get("start")-t.get("start")})):[],s=[];c.forEach((function(t){var n=t.get("start"),c=t.get("end");if(r>=c){var i=e.get("strand")>0?"five":"three";s.push({type:"".concat(i,"_prime_UTR"),start:n,end:c})}else if(r>n&&r<c&&a>=c){var u=e.get("strand")>0?"five":"three";s.push({type:"".concat(u,"_prime_UTR"),start:n,end:r},{type:"CDS",start:r,end:c})}else if(r<=n&&a>=c)s.push({type:"CDS",start:n,end:c});else if(r>n&&r<c&&a<c){var o=e.get("strand")>0?"five":"three",d=e.get("strand")>0?"three":"five";s.push({type:"".concat(o,"_prime_UTR"),start:n,end:r},{type:"CDS",start:r,end:a},{type:"".concat(d,"_prime_UTR"),start:a,end:c})}else if(r<=n&&a>n&&a<c){var f=e.get("strand")>0?"three":"five";s.push({type:"CDS",start:n,end:a},{type:"".concat(f,"_prime_UTR"),start:a,end:c})}else if(a<=n){var p=e.get("strand")>0?"three":"five";s.push({type:"".concat(p,"_prime_UTR"),start:n,end:c})}}));var i={};return e.tags().forEach((function(t){i[t]=e.get(t)})),i.subfeatures=s,i.type="mRNA",i.uniqueId=e.id(),delete i.chromStarts,delete i.chromStart,delete i.chromEnd,delete i.chrom,delete i.blockStarts,delete i.blockSizes,delete i.blockCount,delete i.thickStart,delete i.thickEnd,new n.a({data:i,id:e.id()})}}}]);
//# sourceMappingURL=41.a28682a0.chunk.js.map