(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[19],{2361:function(e,t,n){"use strict";var r=n(2362);e.exports={TwoBitFile:r}},2362:function(e,t,n){"use strict";(function(t){var r=n(175),a=r(n(375)),s=r(n(2363)),u=r(n(382)),i=r(n(838)),o=r(n(236)),c=r(n(237)),f=r(n(210)),l=r(n(225)),d=r(n(870)),h=n(280),p=n(435).Parser,v=void 0;function k(e,t){var n=e.prototype[t],r="_memo_".concat(t);e.prototype[t]=function(){return r in this||(this[r]=n.call(this)),this[r]}}var x=["T","C","A","G"],g=(0,d.default)(Array(256).keys()).map((function(e,t){return x[t>>6&3]+x[t>>4&3]+x[t>>2&3]+x[3&t]})),w=g.map((function(e){return e.toLowerCase()})),b=function(){function e(t){(0,f.default)(this,e),this.fdPromise=v.open(t,"r")}return(0,l.default)(e,[{key:"read",value:function(){var e=(0,c.default)(o.default.mark((function e(t,n,r,a){var s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fdPromise;case 2:return s=e.sent,e.abrupt("return",v.read(s,t,n,r,a));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()}]),e}(),y=function(){function e(t){var n=t.filehandle,r=t.path,a=t.seqChunkSize;(0,f.default)(this,e),n?this.filehandle=n:r&&(this.filehandle=new b(r)),this.isBigEndian=void 0,this.seqChunkSize=a||32e3}return(0,l.default)(e,[{key:"_getParser",value:function(){var e=(0,c.default)(o.default.mark((function e(t){var n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getParsers();case 2:if(e.t0=t,n=e.sent[e.t0]){e.next=6;break}throw new Error("parser ".concat(t," not found"));case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_detectEndianness",value:function(){var e=(0,c.default)(o.default.mark((function e(){var n,r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.filehandle.read(t.allocUnsafe(8),0,8,0);case 2:if(n=e.sent,440477507!==(r=n.buffer).readInt32LE(0)){e.next=9;break}this.isBigEndian=!1,this.version=r.readInt32LE(4),e.next=15;break;case 9:if(440477507!==r.readInt32BE(0)){e.next=14;break}this.isBigEndian=!0,this.version=r.readInt32BE(4),e.next=15;break;case 14:throw new Error("not a 2bit file");case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getParsers",value:function(){var e=(0,c.default)(o.default.mark((function e(){var t,n,r,a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._detectEndianness();case 2:return t=this.isBigEndian?"big":"little",n=this.isBigEndian?"be":"le",r=(new p).endianess(t).uint8("nameLength").string("name",{length:"nameLength"}),r=1===this.version?r.buffer("offsetBytes",{length:8}):r.uint32("offset"),a=(new p).endianess(t).int32("magic",{assert:function(e){return 440477507===e}}).int32("version",{assert:function(e){return 0===e||1===e}}).uint32("sequenceCount",{assert:function(e){return e>=0}}).uint32("reserved"),e.abrupt("return",{header:a,index:(new p).endianess(t).uint32("sequenceCount").uint32("reserved").array("index",{length:"sequenceCount",type:r}),record1:(new p).endianess(t).uint32("dnaSize").uint32("nBlockCount"),record2:(new p).endianess(t).uint32("nBlockCount").array("nBlockStarts",{length:"nBlockCount",type:"uint32".concat(n)}).array("nBlockSizes",{length:"nBlockCount",type:"uint32".concat(n)}).uint32("maskBlockCount"),record3:(new p).endianess(t).uint32("maskBlockCount").array("maskBlockStarts",{length:"maskBlockCount",type:"uint32".concat(n)}).array("maskBlockSizes",{length:"maskBlockCount",type:"uint32".concat(n)}).int32("reserved")});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeader",value:function(){var e=(0,c.default)(o.default.mark((function e(){var n,r,a;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._detectEndianness();case 2:return e.next=4,this.filehandle.read(t.allocUnsafe(16),0,16,0);case 4:return n=e.sent,r=n.buffer,e.next=8,this._getParser("header");case 8:return a=e.sent,e.abrupt("return",a.parse(r).result);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getIndex",value:function(){var e=(0,c.default)(o.default.mark((function e(){var n,r,a,s,u,c,f,l=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getHeader();case 2:return n=e.sent,r=8+n.sequenceCount*(257+(1===this.version?8:4)),e.next=6,this.filehandle.read(t.allocUnsafe(r),0,r,8);case 6:return a=e.sent,s=a.buffer,e.next=10,this._getParser("index");case 10:return u=e.sent,c=u.parse(s).result.index,f={},1===this.version?c.forEach((function(e){var t=e.name,n=e.offsetBytes,r=h.fromBytes(n,!0,!l.isBigEndian);if(r.greaterThan(i.default))throw new Error("integer overflow. File offset greater than 2^53-1 encountered. This library can only handle offsets up to 2^53-1.");f[t]=r.toNumber()})):c.forEach((function(e){var t=e.name,n=e.offset;f[t]=n})),e.abrupt("return",f);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSequenceNames",value:function(){var e=(0,c.default)(o.default.mark((function e(){var t;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIndex();case 2:return t=e.sent,e.abrupt("return",(0,u.default)(t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSequenceSizes",value:function(){var e=(0,c.default)(o.default.mark((function e(){var t,n,r,i,c,f,l=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIndex();case 2:return t=e.sent,n=(0,u.default)(t),r=(0,s.default)(t).map((function(e){return l._getSequenceSize(e)})),e.next=7,a.default.all(r);case 7:for(i=e.sent,c={},f=0;f<n.length;f+=1)c[n[f]]=i[f];return e.abrupt("return",c);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSequenceSize",value:function(){var e=(0,c.default)(o.default.mark((function e(t){var n,r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIndex();case 2:if(n=e.sent,r=n[t]){e.next=6;break}return e.abrupt("return",void 0);case 6:return e.abrupt("return",this._getSequenceSize(r));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getSequenceSize",value:function(){var e=(0,c.default)(o.default.mark((function e(t){var n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(void 0===t||t<0)){e.next=2;break}throw new Error("invalid offset");case 2:return e.next=4,this._parseItem(t,8,"record1");case 4:return n=e.sent,e.abrupt("return",n.dnaSize);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getSequenceRecord",value:function(){var e=(0,c.default)(o.default.mark((function e(t){var n,r,a,s,u,i;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(void 0===t||t<0)){e.next=2;break}throw new Error("invalid offset");case 2:return e.next=4,this._parseItem(t,8,"record1");case 4:return n=e.sent,r=8*n.nBlockCount+8,e.next=8,this._parseItem(t+4,r,"record2");case 8:return a=e.sent,s=8*a.maskBlockCount+8,e.next=12,this._parseItem(t+4+r-4,s,"record3");case 12:return u=e.sent,i={dnaSize:n.dnaSize,nBlocks:{starts:a.nBlockStarts,sizes:a.nBlockSizes},maskBlocks:{starts:u.maskBlockStarts,sizes:u.maskBlockSizes},dnaPosition:t+4+r-4+s},e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_parseItem",value:function(){var e=(0,c.default)(o.default.mark((function e(n,r,a){var s,u,i;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.filehandle.read(t.allocUnsafe(r),0,r,n);case 2:return s=e.sent,u=s.buffer,e.next=6,this._getParser(a);case 6:return i=e.sent,e.abrupt("return",i.parse(u).result);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getSequence",value:function(){var e=(0,c.default)(o.default.mark((function e(n){var r,a,s,u,i,c,f,l,d,h,p,v,k,x,b,y,m,B,S=arguments;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=S.length>1&&void 0!==S[1]?S[1]:0,a=S.length>2?S[2]:void 0,e.next=4,this.getIndex();case 4:if(s=e.sent,u=s[n]){e.next=8;break}return e.abrupt("return",void 0);case 8:return e.next=10,this._getSequenceRecord(u);case 10:if(i=e.sent,!(r<0)){e.next=13;break}throw new TypeError("regionStart cannot be less than 0");case 13:return(void 0===a||a>i.dnaSize)&&(a=i.dnaSize),c=this._getOverlappingBlocks(r,a,i.nBlocks.starts,i.nBlocks.sizes),f=this._getOverlappingBlocks(r,a,i.maskBlocks.starts,i.maskBlocks.sizes),l=t.allocUnsafe(Math.ceil((a-r)/4)+1),d=Math.floor(r/4),e.next=20,this.filehandle.read(l,0,l.length,i.dnaPosition+d);case 20:for(h=e.sent,p=h.buffer,v="",k=r;k<a;k+=1){for(;f.length&&f[0].end<=k;)f.shift();if(x=f[0]&&f[0].start<=k&&f[0].end>k,c[0]&&k>=c[0].start&&k<c[0].end){for(b=c.shift();k<b.end&&k<a;k+=1)v+=x?"n":"N";k-=1}else y=Math.floor(k/4)-d,m=k%4,B=p[y],v+=x?w[B][m]:g[B][m]}return e.abrupt("return",v);case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getOverlappingBlocks",value:function(e,t,n,r){for(var a,s,u=0;u<n.length;u+=1){var i=n[u];if(e>=i+r[u]||t<=i){if(void 0!==a){s=u;break}}else void 0===a&&(a=u)}if(void 0===a)return[];void 0===s&&(s=n.length);for(var o=new Array(s-a),c=a;c<s;c+=1)o[c-a]={start:n[c],end:n[c]+r[c],size:r[c]};return o}}]),e}();k(y,"_getParsers"),k(y,"getIndex"),k(y,"getHeader"),e.exports=y}).call(this,n(107).Buffer)},2363:function(e,t,n){e.exports=n(2364)},2364:function(e,t,n){n(2365),e.exports=n(113).Object.values},2365:function(e,t,n){var r=n(134),a=n(2366)(!1);r(r.S,"Object",{values:function(e){return a(e)}})},2366:function(e,t,n){var r=n(196),a=n(377),s=n(238),u=n(467).f;e.exports=function(e){return function(t){for(var n,i=s(t),o=a(i),c=o.length,f=0,l=[];c>f;)n=o[f++],r&&!u.call(i,n)||l.push(e?[n,i[n]]:i[n]);return l}}},838:function(e,t,n){e.exports=n(839)},839:function(e,t,n){n(840),e.exports=9007199254740991},840:function(e,t,n){var r=n(134);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},870:function(e,t,n){var r=n(871),a=n(872),s=n(612),u=n(873);e.exports=function(e){return r(e)||a(e)||s(e)||u()}},871:function(e,t,n){var r=n(380),a=n(847);e.exports=function(e){if(r(e))return a(e)}},872:function(e,t,n){var r=n(471),a=n(611),s=n(239);e.exports=function(e){if("undefined"!==typeof s&&a(Object(e)))return r(e)}},873:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}}}]);
//# sourceMappingURL=19.39ccb750.chunk.js.map