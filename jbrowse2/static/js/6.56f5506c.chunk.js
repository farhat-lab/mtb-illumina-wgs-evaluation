(this["webpackJsonp@jbrowse/web"]=this["webpackJsonp@jbrowse/web"]||[]).push([[6],{1143:function(t,e,r){"use strict";var n=r(221);r(174)(e,"__esModule",{value:!0}),e.default=void 0;var a=n(r(772)),i=n(r(1155)),o=n(r(783)),u=n(r(1157)),s=n(r(1164)),f=n(r(174)),c=n(r(788)),l=n(r(789)),d=n(r(320)),h=n(r(790)),p=n(r(453)),v=n(r(791)),y=n(r(584)),b=n(r(792)),x=n(r(585)),m=n(r(283)),g=n(r(454)),w=n(r(371)),k=n(r(372)),_=n(r(457)),E=n(r(284)),A=n(r(285)),S=n(r(795)),I=n(r(796)),C=n(r(799)),P=n(r(280)),R=r(1205),B=n(r(1207)),M=n(r(1208)),L=r(800);function T(t,e){var r;if("undefined"===typeof u.default||null==(0,o.default)(t)){if((0,i.default)(t)||(r=function(t,e){var r;if(!t)return;if("string"===typeof t)return F(t,e);var n=(0,_.default)(r=Object.prototype.toString.call(t)).call(r,8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return(0,s.default)(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(t,e)}(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var n=0,f=function(){};return{s:f,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:f}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,d=!1;return{s:function(){r=(0,a.default)(t)},n:function(){var t=r.next();return l=t.done,t},e:function(t){d=!0,c=t},f:function(){try{l||null==r.return||r.return()}finally{if(d)throw c}}}}function F(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function O(t,e){var r=(0,y.default)(t);if(v.default){var n=(0,v.default)(t);e&&(n=(0,p.default)(n).call(n,(function(e){return(0,h.default)(t,e).enumerable}))),r.push.apply(r,n)}return r}function D(t){for(var e=1;e<arguments.length;e++){var r,n=null!=arguments[e]?arguments[e]:{};if(e%2)(0,d.default)(r=O(Object(n),!0)).call(r,(function(e){(0,m.default)(t,e,n[e])}));else if(l.default)(0,c.default)(t,(0,l.default)(n));else{var a;(0,d.default)(a=O(Object(n))).call(a,(function(e){(0,f.default)(t,e,(0,h.default)(n,e))}))}}return t}function U(t){var e=function(){if("undefined"===typeof Reflect||!b.default)return!1;if(b.default.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call((0,b.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,C.default)(t);if(e){var a=(0,C.default)(this).constructor;r=(0,b.default)(n,arguments,a)}else r=n.apply(this,arguments);return(0,I.default)(this,r)}}function z(t,e){return t-t%e}function j(t,e){return t-t%e+e}var q=function(t){(0,S.default)(r,t);var e=U(r);function r(){return(0,E.default)(this,r),e.apply(this,arguments)}return(0,A.default)(r,[{key:"parsePseudoBin",value:function(t,e){return{lineCount:(0,L.longToNumber)(P.default.fromBytesLE((0,_.default)(Array.prototype).call(t,e+16,e+24),!0))}}},{key:"lineCount",value:function(){var t=(0,k.default)(w.default.mark((function t(e){var r,n,a,i,o=arguments;return w.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:{},t.next=3,this.parse(r);case 3:if(n=t.sent,a=n.indices[e]){t.next=7;break}return t.abrupt("return",-1);case 7:return i=a.stats||{},t.abrupt("return",void 0===i.lineCount?-1:i.lineCount);case 9:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"_parse",value:function(){var t=(0,k.default)(w.default.mark((function t(){var e,r,n,a,i,o,u,s,f,c,l,d,h,p,v,y,b,x,m,g=arguments;return w.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=g.length>0&&void 0!==g[0]?g[0]:{},r={bai:!0,maxBlockSize:65536},t.next=4,this.filehandle.readFile(e);case 4:if(21578050===(n=t.sent).readUInt32LE(0)){t.next=7;break}throw new Error("Not a BAI file");case 7:r.refCount=n.readInt32LE(4),a=((1<<3*(5+1))-1)/7,r.indices=new Array(r.refCount),i=8,o=0;case 13:if(!(o<r.refCount)){t.next=50;break}return t.next=16,(0,L.abortBreakPoint)(e.signal);case 16:u=n.readInt32LE(i),s=void 0,i+=4,f={},c=0;case 21:if(!(c<u)){t.next=42;break}if(l=n.readUInt32LE(i),i+=4,l!==a+1){t.next=30;break}i+=4,s=this.parsePseudoBin(n,i),i+=32,t.next=39;break;case 30:if(!(l>a+1)){t.next=34;break}throw new Error("bai index contains too many bins, please use CSI");case 34:for(d=n.readInt32LE(i),i+=4,h=new Array(d),p=0;p<d;p+=1)v=(0,R.fromBytes)(n,i),y=(0,R.fromBytes)(n,i+8),i+=16,this._findFirstData(r,v),h[p]=new B.default(v,y,l);f[l]=h;case 39:c+=1,t.next=21;break;case 42:for(b=n.readInt32LE(i),i+=4,x=new Array(b),m=0;m<b;m+=1)x[m]=(0,R.fromBytes)(n,i),i+=8,this._findFirstData(r,x[m]);r.indices[o]={binIndex:f,linearIndex:x,stats:s};case 47:o+=1,t.next=13;break;case 50:return t.abrupt("return",r);case 51:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"indexCov",value:function(){var t=(0,k.default)(w.default.mark((function t(e,r,n){var a,i,o,u,s,f,c,l,d,h,p,v,y,b,x,m=arguments;return w.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=m.length>3&&void 0!==m[3]?m[3]:{},i=16384,o=void 0!==r,t.next=5,this.parse(a);case 5:if(u=t.sent,s=u.indices[e]){t.next=9;break}return t.abrupt("return",[]);case 9:if(f=s.linearIndex,c=void 0===f?[]:f,l=s.stats,c.length){t.next=12;break}return t.abrupt("return",[]);case 12:if(d=void 0!==n?j(n,i):(c.length-1)*i,h=void 0!==r?z(r,i):0,p=new Array(o?(d-h)/i:c.length-1),v=c[c.length-1].blockPosition,!(d>(c.length-1)*i)){t.next=18;break}throw new Error("query outside of range of linear index");case 18:for(y=c[h/i].blockPosition,b=h/i,x=0;b<d/i;b++,x++)p[x]={score:c[b+1].blockPosition-y,start:b*i,end:b*i+i},y=c[b+1].blockPosition;return t.abrupt("return",(0,g.default)(p).call(p,(function(t){return D(D({},t),{},{score:t.score*l.lineCount/v})})));case 21:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"reg2bins",value:function(t,e){return[[0,0],[1+(t>>26),1+((e-=1)>>26)],[9+(t>>23),9+(e>>23)],[73+(t>>20),73+(e>>20)],[585+(t>>17),585+(e>>17)],[4681+(t>>14),4681+(e>>14)]]}},{key:"blocksForRange",value:function(){var t=(0,k.default)(w.default.mark((function t(e,r,n){var a,i,o,u,s,f,c,l,d,h,p,v,y,b,m,g,k,_,E,A=arguments;return w.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=A.length>3&&void 0!==A[3]?A[3]:{},r<0&&(r=0),t.next=4,this.parse(a);case 4:if(i=t.sent){t.next=7;break}return t.abrupt("return",[]);case 7:if(o=i.indices[e]){t.next=10;break}return t.abrupt("return",[]);case 10:u=this.reg2bins(r,n),s=[],f=T(u);try{for(f.s();!(c=f.n()).done;)for(l=(0,x.default)(c.value,2),d=l[0],h=l[1],p=d;p<=h;p++)if(o.binIndex[p])for(v=o.binIndex[p],y=0;y<v.length;++y)s.push(new B.default(v[y].minv,v[y].maxv,p))}catch(w){f.e(w)}finally{f.f()}for(b=o.linearIndex.length,m=null,g=Math.min(r>>14,b-1),k=Math.min(n>>14,b-1),_=g;_<=k;++_)(E=o.linearIndex[_])&&(!m||E.compareTo(m)<0)&&(m=E);return t.abrupt("return",(0,L.optimizeChunks)(s,m));case 20:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}()}]),r}(M.default);e.default=q},1155:function(t,e,r){t.exports=r(1919)},1157:function(t,e,r){t.exports=r(1922)},1164:function(t,e,r){t.exports=r(1938)},1170:function(t,e,r){r(1953);var n=r(123).Object,a=t.exports=function(t,e){return n.getOwnPropertyDescriptor(t,e)};n.getOwnPropertyDescriptor.sham&&(a.sham=!0)},1172:function(t,e,r){r(1161);var n=r(123);t.exports=n.Object.getOwnPropertySymbols},1177:function(t,e,r){var n=r(1961);t.exports=function(t){if(n(t))return t}},1179:function(t,e,r){t.exports=r(1180)},1182:function(t,e,r){var n=r(1183),a=r(1969),i=r(1972);t.exports=function(t,e){var r;if(t){if("string"===typeof t)return i(t,e);var o=a(r=Object.prototype.toString.call(t)).call(r,8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?n(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?i(t,e):void 0}}},1183:function(t,e,r){t.exports=r(1184)},1187:function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},1200:function(t,e,r){t.exports=r(1201)},1202:function(t,e,r){var n=r(797),a=r(370);function i(e){return t.exports=i="function"===typeof a&&"symbol"===typeof n?function(t){return typeof t}:function(t){return t&&"function"===typeof a&&t.constructor===a&&t!==a.prototype?"symbol":typeof t},i(e)}t.exports=i},1205:function(t,e,r){"use strict";var n=r(221);r(174)(e,"__esModule",{value:!0}),e.fromBytes=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(r)throw new Error("big-endian virtual file offsets not implemented");return new s(1099511627776*t[e+7]+4294967296*t[e+6]+16777216*t[e+5]+65536*t[e+4]+256*t[e+3]+t[e+2],t[e+1]<<8|t[e])},e.default=void 0;var a=n(r(373)),i=n(r(284)),o=n(r(285)),u=n(r(283)),s=function(){function t(e,r){(0,i.default)(this,t),(0,u.default)(this,"blockPosition",void 0),(0,u.default)(this,"dataPosition",void 0),this.blockPosition=e,this.dataPosition=r}return(0,o.default)(t,[{key:"toString",value:function(){var t;return(0,a.default)(t="".concat(this.blockPosition,":")).call(t,this.dataPosition)}},{key:"compareTo",value:function(t){return this.blockPosition-t.blockPosition||this.dataPosition-t.dataPosition}}],[{key:"min",value:function(){for(var t,e=0,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];for(;!t;e+=1)t=n[e];for(;e<n.length;e+=1)t.compareTo(n[e])>0&&(t=n[e]);return t}}]),t}();e.default=s},1207:function(t,e,r){"use strict";var n=r(221);r(174)(e,"__esModule",{value:!0}),e.default=void 0;var a=n(r(373)),i=n(r(284)),o=n(r(285)),u=n(r(283)),s=function(){function t(e,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;(0,i.default)(this,t),(0,u.default)(this,"minv",void 0),(0,u.default)(this,"maxv",void 0),(0,u.default)(this,"bin",void 0),(0,u.default)(this,"_fetchedSize",void 0),this.minv=e,this.maxv=r,this.bin=n,this._fetchedSize=a}return(0,o.default)(t,[{key:"toUniqueString",value:function(){var t,e,r;return(0,a.default)(t=(0,a.default)(e=(0,a.default)(r="".concat(this.minv,"..")).call(r,this.maxv," (bin ")).call(e,this.bin,", fetchedSize ")).call(t,this.fetchedSize(),")")}},{key:"toString",value:function(){return this.toUniqueString()}},{key:"compareTo",value:function(t){return this.minv.compareTo(t.minv)||this.maxv.compareTo(t.maxv)||this.bin-t.bin}},{key:"fetchedSize",value:function(){return void 0!==this._fetchedSize?this._fetchedSize:this.maxv.blockPosition+65536-this.minv.blockPosition}}]),t}();e.default=s},1208:function(t,e,r){"use strict";var n=r(221);r(174)(e,"__esModule",{value:!0}),e.default=void 0;var a=n(r(174)),i=n(r(788)),o=n(r(789)),u=n(r(320)),s=n(r(790)),f=n(r(453)),c=n(r(791)),l=n(r(584)),d=n(r(371)),h=n(r(372)),p=n(r(284)),v=n(r(285)),y=n(r(283)),b=n(r(1209)),x=n(r(276));function m(t,e){var r=(0,l.default)(t);if(c.default){var n=(0,c.default)(t);e&&(n=(0,f.default)(n).call(n,(function(e){return(0,s.default)(t,e).enumerable}))),r.push.apply(r,n)}return r}function g(t){for(var e=1;e<arguments.length;e++){var r,n=null!=arguments[e]?arguments[e]:{};if(e%2)(0,u.default)(r=m(Object(n),!0)).call(r,(function(e){(0,y.default)(t,e,n[e])}));else if(o.default)(0,i.default)(t,(0,o.default)(n));else{var f;(0,u.default)(f=m(Object(n))).call(f,(function(e){(0,a.default)(t,e,(0,s.default)(n,e))}))}}return t}var w=function(){function t(e){var r=e.filehandle,n=e.renameRefSeq,a=void 0===n?function(t){return t}:n;(0,p.default)(this,t),(0,y.default)(this,"filehandle",void 0),(0,y.default)(this,"renameRefSeq",void 0),(0,y.default)(this,"_parseCache",void 0),this.filehandle=r,this.renameRefSeq=a}return(0,v.default)(t,[{key:"_findFirstData",value:function(t,e){var r=t.firstDataLine;t.firstDataLine=r?r.compareTo(e)>0?e:r:e}},{key:"parse",value:function(){var t=(0,h.default)(d.default.mark((function t(){var e,r=this,n=arguments;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{},this._parseCache||(this._parseCache=new b.default({cache:new x.default({maxSize:1}),fill:function(t,e){return r._parse(g(g({},t),{},{signal:e}))}})),t.abrupt("return",this._parseCache.get("index",e,e.signal));case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"hasRefSeq",value:function(){var t=(0,h.default)(d.default.mark((function t(e){var r,n=arguments;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:{},t.next=3,this.parse(r);case 3:if(t.t1=e,t.t0=t.sent.indices[t.t1],t.t0){t.next=7;break}t.t0={};case 7:return t.abrupt("return",!!t.t0.binIndex);case 8:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}]),t}();e.default=w},1209:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(r(1996));e.default=a.default},1210:function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=r(542),a=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof t)return t;throw new Error("unable to locate global object")},i="undefined"===typeof a().AbortController?n.AbortController:a().AbortController;e.AbortController=i;var o="undefined"===typeof a().AbortController?n.AbortSignal:a().AbortSignal;e.AbortSignal=o}).call(this,r(131))},1211:function(t,e,r){t.exports=r(1212)},1216:function(t,e,r){"use strict";var n=r(1217),a=r(221);r(174)(e,"__esModule",{value:!0}),e.default=void 0;var i=a(r(772)),o=a(r(1155)),u=a(r(783)),s=a(r(1157)),f=a(r(1164)),c=a(r(792)),l=a(r(373)),d=a(r(585)),h=a(r(457)),p=a(r(2022)),v=a(r(371)),y=a(r(372)),b=a(r(284)),x=a(r(285)),m=a(r(798)),g=a(r(795)),w=a(r(796)),k=a(r(799)),_=a(r(283)),E=a(r(280)),A=r(321),S=n(r(1205)),I=a(r(1207)),C=r(800),P=a(r(1208));function R(t,e){var r;if("undefined"===typeof s.default||null==(0,u.default)(t)){if((0,o.default)(t)||(r=function(t,e){var r;if(!t)return;if("string"===typeof t)return B(t,e);var n=(0,h.default)(r=Object.prototype.toString.call(t)).call(r,8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return(0,f.default)(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(t,e)}(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,d=!1;return{s:function(){r=(0,i.default)(t)},n:function(){var t=r.next();return l=t.done,t},e:function(t){d=!0,c=t},f:function(){try{l||null==r.return||r.return()}finally{if(d)throw c}}}}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function M(t){var e=function(){if("undefined"===typeof Reflect||!c.default)return!1;if(c.default.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call((0,c.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,k.default)(t);if(e){var a=(0,k.default)(this).constructor;r=(0,c.default)(n,arguments,a)}else r=n.apply(this,arguments);return(0,w.default)(this,r)}}function L(t,e){return Math.floor(t/Math.pow(2,e))}var T=function(t){(0,g.default)(r,t);var e=M(r);function r(t){var n;return(0,b.default)(this,r),n=e.call(this,t),(0,_.default)((0,m.default)(n),"maxBinNumber",void 0),(0,_.default)((0,m.default)(n),"depth",void 0),(0,_.default)((0,m.default)(n),"minShift",void 0),n.maxBinNumber=0,n.depth=0,n.minShift=0,n}return(0,x.default)(r,[{key:"lineCount",value:function(){var t=(0,y.default)(v.default.mark((function t(e){var r,n;return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.parse();case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return",-1);case 5:if(r.indices[e]){t.next=8;break}return t.abrupt("return",-1);case 8:if(!(n=r.indices[e].stats)){t.next=11;break}return t.abrupt("return",n.lineCount);case 11:return t.abrupt("return",-1);case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"indexCov",value:function(){var t=(0,y.default)(v.default.mark((function t(){return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",[]);case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"parseAuxData",value:function(t,e,r){if(r<30)return{};var n={};if(n.formatFlags=t.readInt32LE(e),n.coordinateType=65536&n.formatFlags?"zero-based-half-open":"1-based-closed",n.format={0:"generic",1:"SAM",2:"VCF"}[15&n.formatFlags],!n.format)throw new Error("invalid Tabix preset format flags ".concat(n.formatFlags));n.columnNumbers={ref:t.readInt32LE(e+4),start:t.readInt32LE(e+8),end:t.readInt32LE(e+12)},n.metaValue=t.readInt32LE(e+16),n.metaChar=n.metaValue?String.fromCharCode(n.metaValue):"",n.skipLines=t.readInt32LE(e+20);var a=t.readInt32LE(e+24);return(0,p.default)(n,this._parseNameBytes((0,h.default)(t).call(t,e+28,e+28+a))),n}},{key:"_parseNameBytes",value:function(t){for(var e=0,r=0,n=[],a={},i=0;i<t.length;i+=1)if(!t[i]){if(r<i){var o=t.toString("utf8",r,i);o=this.renameRefSeq(o),n[e]=o,a[o]=e}r=i+1,e+=1}return{refNameToId:a,refIdToName:n}}},{key:"_parse",value:function(){var t=(0,y.default)(v.default.mark((function t(e){var r,n,a,i,o,u,s,f,c,l,d,h,y,b,x,m,g;return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={csi:!0,maxBlockSize:65536},t.next=3,this.filehandle.readFile(e);case 3:return n=t.sent,t.next=6,(0,A.unzip)(n);case 6:if(21582659!==(a=t.sent).readUInt32LE(0)){t.next=11;break}r.csiVersion=1,t.next=16;break;case 11:if(38359875!==a.readUInt32LE(0)){t.next=15;break}r.csiVersion=2,t.next=16;break;case 15:throw new Error("Not a CSI file");case 16:this.minShift=a.readInt32LE(4),this.depth=a.readInt32LE(8),this.maxBinNumber=((1<<3*(this.depth+1))-1)/7,(i=a.readInt32LE(12))&&(0,p.default)(r,this.parseAuxData(a,16,i)),r.refCount=a.readInt32LE(16+i),r.indices=new Array(r.refCount),o=16+i+4,u=0;case 25:if(!(u<r.refCount)){t.next=37;break}return t.next=28,(0,C.abortBreakPoint)(e.signal);case 28:for(s=a.readInt32LE(o),o+=4,f={},c=void 0,l=0;l<s;l+=1)if((d=a.readUInt32LE(o))>this.maxBinNumber)c=this.parsePseudoBin(a,o+4),o+=48;else{for(h=(0,S.fromBytes)(a,o+4),this._findFirstData(r,h),y=a.readInt32LE(o+12),o+=16,b=new Array(y),x=0;x<y;x+=1)m=(0,S.fromBytes)(a,o),g=(0,S.fromBytes)(a,o+8),o+=16,b[x]=new I.default(m,g,d);f[d]=b}r.indices[u]={binIndex:f,stats:c};case 34:u+=1,t.next=25;break;case 37:return t.abrupt("return",r);case 38:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"parsePseudoBin",value:function(t,e){return{lineCount:(0,C.longToNumber)(E.default.fromBytesLE((0,h.default)(Array.prototype).call(t,e+28,e+36),!0))}}},{key:"blocksForRange",value:function(){var t=(0,y.default)(v.default.mark((function t(e,r,n){var a,i,o,u,s,f,c,l,h,p,y,b,x,m=arguments;return v.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=m.length>3&&void 0!==m[3]?m[3]:{},r<0&&(r=0),t.next=4,this.parse(a);case 4:if(i=t.sent){t.next=7;break}return t.abrupt("return",[]);case 7:if(o=i.indices[e]){t.next=10;break}return t.abrupt("return",[]);case 10:u=this.reg2bins(r,n),s=[],f=R(u);try{for(f.s();!(c=f.n()).done;)for(l=(0,d.default)(c.value,2),h=l[0],p=l[1],y=h;y<=p;y++)if(o.binIndex[y])for(b=o.binIndex[y],x=0;x<b.length;++x)s.push(new I.default(b[x].minv,b[x].maxv,y))}catch(v){f.e(v)}finally{f.f()}return t.abrupt("return",(0,C.optimizeChunks)(s,new S.default(0,0)));case 15:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"reg2bins",value:function(t,e){(t-=1)<1&&(t=1),e>Math.pow(2,50)&&(e=Math.pow(2,34)),e-=1;for(var r,n=0,a=0,i=this.minShift+3*this.depth,o=[];n<=this.depth;i-=3,a+=(r=3*n,1*Math.pow(2,r)),n+=1){var u,s,f,c=a+L(t,i),d=a+L(e,i);if(d-c+o.length>this.maxBinNumber)throw new Error((0,l.default)(u=(0,l.default)(s=(0,l.default)(f="query ".concat(t,"-")).call(f,e," is too large for current binning scheme (shift ")).call(s,this.minShift,", depth ")).call(u,this.depth,"), try a smaller query or a coarser index binning scheme"));o.push([c,d])}return o}}]),r}(P.default);e.default=T},1217:function(t,e,r){var n=r(2010),a=r(793),i=r(1202),o=r(2012);function u(){if("function"!==typeof o)return null;var t=new o;return u=function(){return t},t}t.exports=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!==typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var r={},o=a&&n;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){var f=o?n(t,s):null;f&&(f.get||f.set)?a(r,s,f):r[s]=t[s]}return r.default=t,e&&e.set(t,r),r}},1225:function(t,e,r){"use strict";(function(t){var n=r(221);r(174)(e,"__esModule",{value:!0}),e.default=e.BAM_MAGIC=void 0;var a=n(r(1211)),i=n(r(453)),o=n(r(585)),u=n(r(320)),s=n(r(801)),f=n(r(454)),c=n(r(2034)),l=n(r(373)),d=n(r(371)),h=n(r(457)),p=n(r(372)),v=n(r(2039)),y=n(r(284)),b=n(r(285)),x=n(r(283)),m=n(r(1229)),g=n(r(1232)),w=n(r(1233)),k=n(r(1234)),_=n(r(1209)),E=n(r(1143)),A=n(r(1216)),S=n(r(1235)),I=r(321),C=n(r(1055)),P=n(r(276)),R=r(355),B=n(r(1236)),M=r(1241),L=r(800);e.BAM_MAGIC=21840194;var T=function(){function e(t){var r,n=t.bamFilehandle,a=t.bamPath,i=t.bamUrl,o=t.baiPath,u=t.baiFilehandle,s=t.baiUrl,f=t.csiPath,c=t.csiFilehandle,l=t.csiUrl,d=t.cacheSize,h=t.fetchSizeLimit,p=t.chunkSizeLimit,b=t.renameRefSeqs,m=void 0===b?function(t){return t}:b;if((0,y.default)(this,e),(0,x.default)(this,"renameRefSeq",void 0),(0,x.default)(this,"bam",void 0),(0,x.default)(this,"index",void 0),(0,x.default)(this,"chunkSizeLimit",void 0),(0,x.default)(this,"fetchSizeLimit",void 0),(0,x.default)(this,"header",void 0),(0,x.default)(this,"featureCache",void 0),(0,x.default)(this,"chrToIndex",void 0),(0,x.default)(this,"indexToChr",void 0),this.renameRefSeq=m,n)this.bam=n;else if(a)this.bam=new R.LocalFile(a);else{if(!i)throw new Error("unable to initialize bam");this.bam=new R.RemoteFile(i)}if(c)this.index=new A.default({filehandle:c});else if(f)this.index=new A.default({filehandle:new R.LocalFile(f)});else if(l)this.index=new A.default({filehandle:new R.RemoteFile(l)});else if(u)this.index=new E.default({filehandle:u});else if(o)this.index=new E.default({filehandle:new R.LocalFile(o)});else if(s)this.index=new E.default({filehandle:new R.RemoteFile(s)});else if(a)this.index=new E.default({filehandle:new R.LocalFile("".concat(a,".bai"))});else{if(!i)throw new Error("unable to infer index format");this.index=new E.default({filehandle:new R.RemoteFile("".concat(i,".bai"))})}this.featureCache=new _.default({cache:new P.default({maxSize:void 0!==d?d:50}),fill:(0,v.default)(r=this._readChunk).call(r,this)}),this.fetchSizeLimit=h||5e8,this.chunkSizeLimit=p||3e8}return(0,b.default)(e,[{key:"getHeader",value:function(){var e=(0,p.default)(d.default.mark((function e(){var r,n,a,i,o,u,s,f,c,l,p,v,y=arguments;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y.length>0&&void 0!==y[0]?y[0]:{},n=(0,L.makeOpts)(r),e.next=4,this.index.parse(n);case 4:if(a=e.sent,!(i=a.firstDataLine?a.firstDataLine.blockPosition+65535:void 0)){e.next=17;break}return e.next=9,this.bam.read(t.alloc(i+65536),0,i+65536,0,n);case 9:if(u=e.sent,s=u.bytesRead,o=u.buffer,s){e.next=14;break}throw new Error("Error reading header");case 14:o=s<i?(0,h.default)(o).call(o,0,s):(0,h.default)(o).call(o,0,i),e.next=20;break;case 17:return e.next=19,this.bam.readFile(n);case 19:o=e.sent;case 20:return e.next=22,(0,I.unzip)(o);case 22:if(21840194===(f=e.sent).readInt32LE(0)){e.next=25;break}throw new Error("Not a BAM file");case 25:return c=f.readInt32LE(4),this.header=f.toString("utf8",8,8+c),e.next=29,this._readRefSeqs(c+8,65535,n);case 29:return l=e.sent,p=l.chrToIndex,v=l.indexToChr,this.chrToIndex=p,this.indexToChr=v,e.abrupt("return",(0,M.parseHeaderText)(this.header));case 35:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeaderText",value:function(){var t=(0,p.default)(d.default.mark((function t(){var e,r=arguments;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.length>0&&void 0!==r[0]?r[0]:{},t.next=3,this.getHeader(e);case 3:return t.abrupt("return",this.header);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_readRefSeqs",value:function(){var e=(0,p.default)(d.default.mark((function e(r,n){var a,i,o,u,s,f,c,l,p,v,y,b,x,m=arguments;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=m.length>2&&void 0!==m[2]?m[2]:{},!(r>n)){e.next=3;break}return e.abrupt("return",this._readRefSeqs(r,2*n,a));case 3:return e.next=5,this.bam.read(t.alloc(n+65536),0,n,0,a);case 5:if(i=e.sent,o=i.bytesRead,u=i.buffer,o){e.next=10;break}throw new Error("Error reading refseqs from header");case 10:return u=o<n?(0,h.default)(u).call(u,0,o):(0,h.default)(u).call(u,0,n),e.next=13,(0,I.unzip)(u);case 13:s=e.sent,f=s.readInt32LE(r),c=r+4,l={},p=[],v=0;case 19:if(!(v<f)){e.next=35;break}return e.next=22,(0,L.abortBreakPoint)(a.signal);case 22:if(y=s.readInt32LE(c),b=s.toString("utf8",c+4,c+4+y-1),b=this.renameRefSeq(b),x=s.readInt32LE(c+y+4),l[b]=v,p.push({refName:b,length:x}),!((c=c+8+y)>s.length)){e.next=32;break}return console.warn("BAM header is very big.  Re-fetching ".concat(n," bytes.")),e.abrupt("return",this._readRefSeqs(r,2*n,a));case 32:v+=1,e.next=19;break;case 35:return e.abrupt("return",{chrToIndex:l,indexToChr:p});case 36:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getRecordsForRange",value:function(){var t=(0,p.default)(d.default.mark((function t(e,r,n){var a,i,o,u,s,f,c,h,p,v=arguments;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=v.length>3&&void 0!==v[3]?v[3]:{viewAsPairs:!1,pairAcrossChr:!1,maxInsertSize:2e5},i=[],o=!0,u=!1,t.prev=4,f=(0,k.default)(this.streamRecordsForRange(e,r,n,a));case 6:return t.next=8,f.next();case 8:return c=t.sent,o=c.done,t.next=12,c.value;case 12:if(h=t.sent,o){t.next=19;break}p=h,i=(0,l.default)(i).call(i,p);case 16:o=!0,t.next=6;break;case 19:t.next=25;break;case 21:t.prev=21,t.t0=t.catch(4),u=!0,s=t.t0;case 25:if(t.prev=25,t.prev=26,o||null==f.return){t.next=30;break}return t.next=30,f.return();case 30:if(t.prev=30,!u){t.next=33;break}throw s;case 33:return t.finish(30);case 34:return t.finish(25);case 35:return t.abrupt("return",i);case 36:case"end":return t.stop()}}),t,this,[[4,21,25,35],[26,,30,34]])})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"streamRecordsForRange",value:function(t,e,r){var n=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{viewAsPairs:!1,pairAcrossChr:!1,maxInsertSize:2e5};return(0,m.default)(d.default.mark((function i(){var o,u,s,h,p,v,y,b;return d.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a.viewAsPairs=a.viewAsPairs||!1,a.pairAcrossChr=a.pairAcrossChr||!1,a.maxInsertSize=void 0!==a.maxInsertSize?a.maxInsertSize:2e5,(u=n.chrToIndex&&n.chrToIndex[t])>=0){i.next=8;break}s=[],i.next=13;break;case 8:return i.next=10,(0,g.default)(n.index.blocksForRange(u,e-1,r,a));case 10:if(s=i.sent){i.next=13;break}throw new Error("Error in index fetch");case 13:h=0;case 14:if(!(h<s.length)){i.next=23;break}return i.next=17,(0,g.default)((0,L.abortBreakPoint)(a.signal));case 17:if(!((p=s[h].fetchedSize())>n.chunkSizeLimit)){i.next=20;break}throw new Error((0,l.default)(v="Too many BAM features. BAM chunk size ".concat(p," bytes exceeds chunkSizeLimit of ")).call(v,n.chunkSizeLimit));case 20:h+=1,i.next=14;break;case 23:if(!((y=(0,c.default)(o=(0,f.default)(s).call(s,(function(t){return t.fetchedSize()}))).call(o,(function(t,e){return t+e}),0))>n.fetchSizeLimit)){i.next=26;break}throw new Error((0,l.default)(b="data size of ".concat(y.toLocaleString()," bytes exceeded fetch size limit of ")).call(b,n.fetchSizeLimit.toLocaleString()," bytes"));case 26:return i.delegateYield((0,w.default)((0,k.default)(n._fetchChunkFeatures(s,u,e,r,a)),g.default),"t0",27);case 27:case"end":return i.stop()}}),i)})))()}},{key:"_fetchChunkFeatures",value:function(t,e,r,n,a){var i=this;return(0,m.default)(d.default.mark((function o(){var u,s,f,c,l,h,p,v,y,b,x;return d.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:u=[],s=!1,f=0;case 3:if(!(f<t.length)){o.next=21;break}return c=t[f],o.next=7,(0,g.default)(i.featureCache.get(c.toString(),{chunk:c,opts:a},a.signal));case 7:return l=o.sent,h=l.data,p=l.cpositions,v=l.dpositions,y=l.chunk,b=i.readBamFeatures(h,p,v,y).then((function(t){for(var a=[],i=0;i<t.length;i+=1){var o=t[i];if(o.seq_id()===e){if(o.get("start")>=n){s=!0;break}o.get("end")>=r&&a.push(o)}}return a})),u.push(b),o.next=16,(0,g.default)(b);case 16:if(!s){o.next=18;break}return o.abrupt("break",21);case 18:f++,o.next=3;break;case 21:(0,L.checkAbortSignal)(a.signal),x=0;case 23:if(!(x<u.length)){o.next=29;break}return o.next=26,u[x];case 26:x++,o.next=23;break;case 29:if((0,L.checkAbortSignal)(a.signal),!a.viewAsPairs){o.next=33;break}return o.next=33,i.fetchPairs(e,u,a);case 33:case"end":return o.stop()}}),o)})))()}},{key:"fetchPairs",value:function(){var t=(0,p.default)(d.default.mark((function t(e,r,n){var h,v,y,b,x,m,g,w,k,_,E,A,S,I,P=this;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return y={},b={},t.next=4,s.default.all((0,f.default)(r).call(r,function(){var t=(0,p.default)(d.default.mark((function t(e){var r,n,a,i,s,f;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:for(n=t.sent,a={},i=0;i<n.length;i++)s=n[i].name(),f=n[i].id(),a[s]||(a[s]=0),a[s]++,b[f]=1;(0,u.default)(r=(0,C.default)(a)).call(r,(function(t){var e=(0,o.default)(t,2),r=e[0];1===e[1]&&(y[r]=!0)}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 4:return x=[],t.next=7,s.default.all((0,f.default)(r).call(r,function(){var t=(0,p.default)(d.default.mark((function t(r){var a,i,o;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r;case 2:for(a=t.sent,i=0;i<a.length;i++)o=a[i].name(),y[o]&&(n.pairAcrossChr||a[i]._next_refid()===e&&Math.abs(a[i].get("start")-a[i]._next_pos())<(n.maxInsertSize||2e5))&&x.push(P.index.blocksForRange(a[i]._next_refid(),a[i]._next_pos(),a[i]._next_pos()+1,n));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 7:return t.next=9,s.default.all(x);case 9:for(m=t.sent,g=[],w=0;w<m.length;w++)g=(0,l.default)(g).call(g,m[w]);if(g=(0,i.default)(h=(0,a.default)(g).call(g)).call(h,(function(t,e,r){return!e||t.toString()!==r[e-1].toString()})),!((k=(0,c.default)(v=(0,f.default)(g).call(g,(function(t){return t.fetchedSize()}))).call(v,(function(t,e){return t+e}),0))>this.fetchSizeLimit)){t.next=16;break}throw new Error((0,l.default)(_="data size of ".concat(k.toLocaleString()," bytes exceeded fetch size limit of ")).call(_,this.fetchSizeLimit.toLocaleString()," bytes"));case 16:return E=(0,f.default)(g).call(g,function(){var t=(0,p.default)(d.default.mark((function t(e){var r,a,i,o,u,s,f,c,l;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.featureCache.get(e.toString(),{chunk:e,opts:n},n.signal);case 2:return r=t.sent,a=r.data,i=r.cpositions,o=r.dpositions,u=r.chunk,t.next=9,P.readBamFeatures(a,i,o,u);case 9:for(s=t.sent,f=[],c=0;c<s.length;c+=1)l=s[c],y[l.get("name")]&&!b[l.id()]&&f.push(l);return t.abrupt("return",f);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=19,s.default.all(E);case 19:return A=t.sent,S=[],A.length&&(I=(0,c.default)(A).call(A,(function(t,e){return(0,l.default)(t).call(t,e)})),S=(0,l.default)(S).call(S,I)),t.abrupt("return",S);case 23:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"_readChunk",value:function(){var e=(0,p.default)(d.default.mark((function e(r,n){var a,i,o,u,s,f,c,l,p,v,y;return d.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.chunk,i=r.opts,u=(o=a).fetchedSize(),e.next=5,this.bam.read(t.alloc(u),0,u,o.minv.blockPosition,i);case 5:if(s=e.sent,f=s.bytesRead,c=s.buffer,(0,L.checkAbortSignal)(n),f){e.next=11;break}return e.abrupt("return",[]);case 11:return c=f<u?(0,h.default)(c).call(c,0,f):(0,h.default)(c).call(c,0,u),e.next=14,(0,I.unzipChunkSlice)(c,a);case 14:return l=e.sent,p=l.buffer,v=l.cpositions,y=l.dpositions,(0,L.checkAbortSignal)(n),e.abrupt("return",{data:p,cpositions:v,dpositions:y,chunk:a});case 20:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"readBamFeatures",value:function(){var t=(0,p.default)(d.default.mark((function t(e,r,n,a){var i,o,u,s,f,c,l;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=0,o=[],u=0,s=0;case 4:if(!(i+4<e.length)){t.next=19;break}if(f=e.readInt32LE(i),c=i+4+f-1,n){for(;i+a.minv.dataPosition>=n[u++];);u--}if(!(c<e.length)){t.next=16;break}if(l=new B.default({bytes:{byteArray:e,start:i,end:c},fileOffset:r?256*r[u]+(i-n[u])+a.minv.dataPosition+1:S.default.signed((0,h.default)(e).call(e,i,c))}),o.push(l),!(++s>500)){t.next=16;break}return t.next=15,(0,L.timeout)(1);case 15:s=0;case 16:i=c+1,t.next=4;break;case 19:return t.abrupt("return",o);case 20:case"end":return t.stop()}}),t)})));return function(e,r,n,a){return t.apply(this,arguments)}}()},{key:"hasRefSeq",value:function(){var t=(0,p.default)(d.default.mark((function t(e){var r;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.chrToIndex&&this.chrToIndex[e],t.abrupt("return",this.index.hasRefSeq(r));case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"lineCount",value:function(){var t=(0,p.default)(d.default.mark((function t(e){var r;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.chrToIndex&&this.chrToIndex[e],t.abrupt("return",this.index.lineCount(r));case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"indexCov",value:function(){var t=(0,p.default)(d.default.mark((function t(e,r,n){var a;return d.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.index.parse();case 2:return a=this.chrToIndex&&this.chrToIndex[e],t.abrupt("return",this.index.indexCov(a,r,n));case 4:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}()}]),e}();e.default=T}).call(this,r(107).Buffer)},1229:function(t,e,r){var n=r(2042);t.exports=function(t){return function(){return new n(t.apply(this,arguments))}}},1230:function(t,e,r){t.exports=r(2043)},1231:function(t,e){t.exports=function(t){this.wrapped=t}},1232:function(t,e,r){var n=r(1231);t.exports=function(t){return new n(t)}},1233:function(t,e,r){var n=r(797),a=r(370),i=r(794);t.exports=function(t,e){var r={},o=!1;function u(r,n){return o=!0,n=new i((function(e){e(t[r](n))})),{done:!1,value:e(n)}}return"function"===typeof a&&n&&(r[n]=function(){return this}),r.next=function(t){return o?(o=!1,t):u("next",t)},"function"===typeof t.throw&&(r.throw=function(t){if(o)throw o=!1,t;return u("throw",t)}),"function"===typeof t.return&&(r.return=function(t){return o?(o=!1,t):u("return",t)}),r}},1234:function(t,e,r){var n=r(783),a=r(797),i=r(1230),o=r(370);t.exports=function(t){var e;if("undefined"!==typeof o){if(i&&null!=(e=t[i]))return e.call(t);if(a&&null!=(e=n(t)))return e.call(t)}throw new TypeError("Object is not async iterable")}},1236:function(t,e,r){"use strict";(function(t){var n=r(221);r(174)(e,"__esModule",{value:!0}),e.default=void 0;var a,i=n(r(2045)),o=n(r(2050)),u=n(r(453)),s=n(r(584)),f=n(r(320)),c=n(r(373)),l=n(r(284)),d=n(r(285)),h=n(r(283)),p=n(r(454)),v=n(r(2054)),y=(0,p.default)(a="=ACMGRSVTWYHKDBN".split("")).call(a,(function(t){return t.charCodeAt(0)})),b="MIDNSHP=X???????".split(""),x=function(){function e(t){(0,l.default)(this,e),(0,h.default)(this,"data",void 0),(0,h.default)(this,"bytes",void 0),(0,h.default)(this,"flags",void 0),(0,h.default)(this,"_id",void 0),(0,h.default)(this,"_refID",void 0),(0,h.default)(this,"_tagOffset",void 0),(0,h.default)(this,"_tagList",[]),(0,h.default)(this,"_allTagsParsed",!1),this.data={},this.bytes={start:t.bytes.start,end:t.bytes.end,byteArray:t.bytes.byteArray},this._id=t.fileOffset;var r=this.bytes,n=r.start,a=r.byteArray;this._refID=a.readInt32LE(n+4),this.data.start=a.readInt32LE(n+8),this.flags=(4294901760&a.readInt32LE(n+16))>>16}return(0,d.default)(e,[{key:"get",value:function(t){return this[t]?(this.data[t]||(this.data[t]=this[t]()),this.data[t]):this._get(t.toLowerCase())}},{key:"end",value:function(){return this.get("start")+(this.get("length_on_ref")||this.get("seq_length")||void 0)}},{key:"seq_id",value:function(){return this._refID}},{key:"_get",value:function(t){return t in this.data||(this.data[t]=this._parseTag(t)),this.data[t]}},{key:"_tags",value:function(){var t,e=this;this._parseAllTags();var r=["seq"];this.isSegmentUnmapped()||r.push("start","end","strand","score","qual","MQ","CIGAR","length_on_ref","template_length"),this.isPaired()&&r.push("next_segment_position","pair_orientation"),r=(0,c.default)(r).call(r,this._tagList||[]),(0,f.default)(t=(0,s.default)(this.data)).call(t,(function(t){"_"!==t[0]&&"next_seq_id"!==t&&r.push(t)}));var n={};return r=(0,u.default)(r).call(r,(function(t){if(t in e.data&&void 0===e.data[t]||"CG"===t||"cg"===t)return!1;var r=t.toLowerCase(),a=n[r];return n[r]=!0,!a}))}},{key:"parent",value:function(){}},{key:"children",value:function(){return this.get("subfeatures")}},{key:"id",value:function(){return this._id}},{key:"mq",value:function(){var t=(65280&this.get("_bin_mq_nl"))>>8;return 255===t?void 0:t}},{key:"score",value:function(){return this.get("mq")}},{key:"qual",value:function(){var t;return null===(t=this.qualRaw())||void 0===t?void 0:t.join(" ")}},{key:"qualRaw",value:function(){if(!this.isSegmentUnmapped()){for(var e=this.bytes.byteArray,r=this.bytes.start+36+this.get("_l_read_name")+4*this.get("_n_cigar_op")+this.get("_seq_bytes"),n=this.get("seq_length"),a=t.allocUnsafe(n),i=0;i<n;++i)a[i]=e[r+i];return a}}},{key:"strand",value:function(){return this.isReverseComplemented()?-1:1}},{key:"multi_segment_next_segment_strand",value:function(){if(!this.isMateUnmapped())return this.isMateReverseComplemented()?-1:1}},{key:"name",value:function(){return this.get("_read_name")}},{key:"_read_name",value:function(){var t=this.get("_l_read_name");return this.bytes.byteArray.toString("ascii",this.bytes.start+36,this.bytes.start+36+t-1)}},{key:"_parseTag",value:function(t){if(!this._allTagsParsed){for(var e,r=this.bytes.byteArray,n=this._tagOffset||this.bytes.start+36+this.get("_l_read_name")+4*this.get("_n_cigar_op")+this.get("_seq_bytes")+this.get("seq_length"),a=this.bytes.end;n<a&&e!==t;){var i=String.fromCharCode(r[n],r[n+1]);e=i.toLowerCase();var o=String.fromCharCode(r[n+2]);n+=3;var u=void 0;switch(o){case"A":u=String.fromCharCode(r[n]),n+=1;break;case"i":u=r.readInt32LE(n),n+=4;break;case"I":u=r.readUInt32LE(n),n+=4;break;case"c":u=r.readInt8(n),n+=1;break;case"C":u=r.readUInt8(n),n+=1;break;case"s":u=r.readInt16LE(n),n+=2;break;case"S":u=r.readUInt16LE(n),n+=2;break;case"f":u=r.readFloatLE(n),n+=4;break;case"Z":case"H":for(u="";n<=a;){var s=r[n++];if(0===s)break;u+=String.fromCharCode(s)}break;case"B":u="";var f=r[n++],c=String.fromCharCode(f),l=r.readInt32LE(n);if(n+=4,"i"===c)if("CG"===i)for(var d=0;d<l;d++){var h=r.readInt32LE(n);u+=(h>>4)+b[15&h],n+=4}else for(var p=0;p<l;p++)u+=r.readInt32LE(n),p+1<l&&(u+=","),n+=4;if("I"===c)if("CG"===i)for(var v=0;v<l;v++){var y=r.readUInt32LE(n);u+=(y>>4)+b[15&y],n+=4}else for(var x=0;x<l;x++)u+=r.readUInt32LE(n),x+1<l&&(u+=","),n+=4;if("s"===c)for(var m=0;m<l;m++)u+=r.readInt16LE(n),m+1<l&&(u+=","),n+=2;if("S"===c)for(var g=0;g<l;g++)u+=r.readUInt16LE(n),g+1<l&&(u+=","),n+=2;if("c"===c)for(var w=0;w<l;w++)u+=r.readInt8(n),w+1<l&&(u+=","),n+=1;if("C"===c)for(var k=0;k<l;k++)u+=r.readUInt8(n),k+1<l&&(u+=","),n+=1;if("f"===c)for(var _=0;_<l;_++)u+=r.readFloatLE(n),_+1<l&&(u+=","),n+=4;break;default:console.warn("Unknown BAM tag type '".concat(o,"', tags may be incomplete")),u=void 0,n=a}if(this._tagOffset=n,this._tagList.push(i),e===t)return u;this.data[e]=u}this._allTagsParsed=!0}}},{key:"_parseAllTags",value:function(){this._parseTag("")}},{key:"_parseCigar",value:function(t){var e;return(0,p.default)(e=t.match(/\d+\D/g)).call(e,(function(t){return[t.match(/\D/)[0].toUpperCase(),(0,o.default)(t,10)]}))}},{key:"isPaired",value:function(){return!!((0,i.default)(this)&v.default.BAM_FPAIRED)}},{key:"isProperlyPaired",value:function(){return!!((0,i.default)(this)&v.default.BAM_FPROPER_PAIR)}},{key:"isSegmentUnmapped",value:function(){return!!((0,i.default)(this)&v.default.BAM_FUNMAP)}},{key:"isMateUnmapped",value:function(){return!!((0,i.default)(this)&v.default.BAM_FMUNMAP)}},{key:"isReverseComplemented",value:function(){return!!((0,i.default)(this)&v.default.BAM_FREVERSE)}},{key:"isMateReverseComplemented",value:function(){return!!((0,i.default)(this)&v.default.BAM_FMREVERSE)}},{key:"isRead1",value:function(){return!!((0,i.default)(this)&v.default.BAM_FREAD1)}},{key:"isRead2",value:function(){return!!((0,i.default)(this)&v.default.BAM_FREAD2)}},{key:"isSecondary",value:function(){return!!((0,i.default)(this)&v.default.BAM_FSECONDARY)}},{key:"isFailedQc",value:function(){return!!((0,i.default)(this)&v.default.BAM_FQCFAIL)}},{key:"isDuplicate",value:function(){return!!((0,i.default)(this)&v.default.BAM_FDUP)}},{key:"isSupplementary",value:function(){return!!((0,i.default)(this)&v.default.BAM_FSUPPLEMENTARY)}},{key:"cigar",value:function(){if(!this.isSegmentUnmapped()){var t=this.bytes,e=t.byteArray,r=t.start,n=this.get("_n_cigar_op"),a=r+36+this.get("_l_read_name"),i=this.get("seq_length"),o="",u=0,s=e.readInt32LE(a),f=s>>4,c=b[15&s];if("S"===c&&f===i)return a+=4,f=(s=e.readInt32LE(a))>>4,"N"!==(c=b[15&s])&&console.warn("CG tag with no N tag"),this.data.length_on_ref=f,this.get("CG");for(var l=0;l<n;++l)o+=(f=(s=e.readInt32LE(a))>>4)+(c=b[15&s]),"H"!==c&&"S"!==c&&"I"!==c&&(u+=f),a+=4;return this.data.length_on_ref=u,o}}},{key:"_flags",value:function(){}},{key:"length_on_ref",value:function(){return this.get("cigar"),this.data.length_on_ref}},{key:"_n_cigar_op",value:function(){return 65535&this.get("_flag_nc")}},{key:"_l_read_name",value:function(){return 255&this.get("_bin_mq_nl")}},{key:"_seq_bytes",value:function(){return this.get("seq_length")+1>>1}},{key:"getReadBases",value:function(){return this.seq()}},{key:"seq",value:function(){for(var t=this.bytes.byteArray,e=this.bytes.start+36+this.get("_l_read_name")+4*this.get("_n_cigar_op"),r=this.get("_seq_bytes"),n=this.get("seq_length"),a="",i=0,o=0;o<r;++o){var u=t[e+o];a+=String.fromCharCode(y[(240&u)>>4]),++i<n&&(a+=String.fromCharCode(y[15&u]),i++)}return a}},{key:"getPairOrientation",value:function(){if(!this.isSegmentUnmapped()&&!this.isMateUnmapped()&&this._refID===this._next_refid()){var t=this.isReverseComplemented()?"R":"F",e=this.isMateReverseComplemented()?"R":"F",r=" ",n=" ";this.isRead1()?(r="1",n="2"):this.isRead2()&&(r="2",n="1");var a=[];return this.template_length()>0?(a[0]=t,a[1]=r,a[2]=e,a[3]=n):(a[2]=t,a[3]=r,a[0]=e,a[1]=n),a.join("")}return null}},{key:"_bin_mq_nl",value:function(){return this.bytes.byteArray.readInt32LE(this.bytes.start+12)}},{key:"_flag_nc",value:function(){return this.bytes.byteArray.readInt32LE(this.bytes.start+16)}},{key:"seq_length",value:function(){return this.bytes.byteArray.readInt32LE(this.bytes.start+20)}},{key:"_next_refid",value:function(){return this.bytes.byteArray.readInt32LE(this.bytes.start+24)}},{key:"_next_pos",value:function(){return this.bytes.byteArray.readInt32LE(this.bytes.start+28)}},{key:"template_length",value:function(){return this.bytes.byteArray.readInt32LE(this.bytes.start+32)}},{key:"toJSON",value:function(){var t,e=this,r={};return(0,f.default)(t=(0,s.default)(this)).call(t,(function(t){"_"!==t.charAt(0)&&"bytes"!==t&&(r[t]=e[t])})),r}}]),e}();e.default=x}).call(this,r(107).Buffer)},1241:function(t,e,r){"use strict";var n=r(221);r(174)(e,"__esModule",{value:!0}),e.parseHeaderText=function(t){var e=t.split(/\r?\n/),r=[];return(0,s.default)(e).call(e,(function(t){var e=t.split(/\t/),n=(0,u.default)(e),s=n[0],f=(0,o.default)(n).call(n,1),c=(0,i.default)(f).call(f,(function(t){var e=t.split(":",2),r=(0,a.default)(e,2);return{tag:r[0],value:r[1]}}));s&&r.push({tag:s.substr(1),data:c})})),r};var a=n(r(585)),i=n(r(454)),o=n(r(457)),u=n(r(2055)),s=n(r(320))},1242:function(t,e,r){t.exports=r(1243)},174:function(t,e,r){t.exports=r(1910)},1910:function(t,e,r){var n=r(1140);t.exports=n},1919:function(t,e,r){var n=r(1156);t.exports=n},1921:function(t,e,r){r(281),r(318);var n=r(579);t.exports=n},1922:function(t,e,r){var n=r(1158);t.exports=n},1938:function(t,e,r){var n=r(1165);t.exports=n},1941:function(t,e,r){var n=r(1942);t.exports=n},1942:function(t,e,r){r(1943);var n=r(123).Object,a=t.exports=function(t,e){return n.defineProperties(t,e)};n.defineProperties.sham&&(a.sham=!0)},1943:function(t,e,r){var n=r(97),a=r(161);n({target:"Object",stat:!0,forced:!a,sham:!a},{defineProperties:r(1151)})},1944:function(t,e,r){var n=r(1945);t.exports=n},1945:function(t,e,r){r(1946);var n=r(123);t.exports=n.Object.getOwnPropertyDescriptors},1946:function(t,e,r){var n=r(97),a=r(161),i=r(1947),o=r(234),u=r(366),s=r(580);n({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(t){for(var e,r,n=o(t),a=u.f,f=i(n),c={},l=0;f.length>l;)void 0!==(r=a(n,e=f[l++]))&&s(c,e,r);return c}})},1947:function(t,e,r){var n=r(209),a=r(786),i=r(787),o=r(122);t.exports=n("Reflect","ownKeys")||function(t){var e=a.f(o(t)),r=i.f;return r?e.concat(r(t)):e}},1952:function(t,e,r){var n=r(1170);t.exports=n},1953:function(t,e,r){var n=r(97),a=r(143),i=r(234),o=r(366).f,u=r(161),s=a((function(){o(1)}));n({target:"Object",stat:!0,forced:!u||s,sham:!u},{getOwnPropertyDescriptor:function(t,e){return o(i(t),e)}})},1957:function(t,e,r){var n=r(1172);t.exports=n},1959:function(t,e,r){var n=r(1175);t.exports=n},1961:function(t,e,r){t.exports=r(1178)},1962:function(t,e,r){var n=r(772),a=r(1179),i=r(370);t.exports=function(t,e){if("undefined"!==typeof i&&a(Object(t))){var r=[],o=!0,u=!1,s=void 0;try{for(var f,c=n(t);!(o=(f=c.next()).done)&&(r.push(f.value),!e||r.length!==e);o=!0);}catch(l){u=!0,s=l}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}return r}}},1969:function(t,e,r){t.exports=r(1185)},1972:function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}},1984:function(t,e,r){t.exports=r(1199)},1987:function(t,e,r){var n=r(1200);function a(e,r){return t.exports=a=n||function(t,e){return t.__proto__=e,t},a(e,r)}t.exports=a},1991:function(t,e,r){t.exports=r(1204)},1996:function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(1210),i=n(r(1997)),o=function(){function t(t){var e=t.fill,r=t.cache;if("function"!==typeof e)throw new TypeError("must pass a fill function");if("object"!==typeof r)throw new TypeError("must pass a cache object");if("function"!==typeof r.get||"function"!==typeof r.set||"function"!==typeof r.delete)throw new TypeError("cache must implement get(key), set(key, val), and and delete(key)");this.cache=r,this.fillCallback=e}return t.isAbortException=function(t){return"AbortError"===t.name||"ERR_ABORTED"===t.code||"AbortError: aborted"===t.message||"Error: aborted"===t.message},t.prototype.evict=function(t,e){this.cache.get(t)===e&&this.cache.delete(t)},t.prototype.fill=function(t,e,r){var n=this,a=new i.default,o={aborter:a,promise:this.fillCallback(e,a.signal),settled:!1,get aborted(){return this.aborter.signal.aborted}};o.aborter.addSignal(r),o.aborter.signal.addEventListener("abort",(function(){n.evict(t,o)})),o.promise.then((function(){o.settled=!0}),(function(e){o.settled=!0,n.evict(t,o)})).catch((function(t){throw console.error(t),t})),this.cache.set(t,o)},t.checkSinglePromise=function(t,e){function r(){if(e&&e.aborted)throw Object.assign(new Error("aborted"),{code:"ERR_ABORTED"})}return t.then((function(t){return r(),t}),(function(t){throw r(),t}))},t.prototype.has=function(t){return this.cache.has(t)},t.prototype.get=function(e,r,n){if(!n&&r instanceof a.AbortSignal)throw new TypeError("second get argument appears to be an AbortSignal, perhaps you meant to pass `null` for the fill data?");var i=this.cache.get(e);return i?i.aborted?(this.evict(e,i),this.get(e,r,n)):i.settled?i.promise:(i.aborter.addSignal(n),t.checkSinglePromise(i.promise,n)):(this.fill(e,r,n),t.checkSinglePromise(this.cache.get(e).promise,n))},t.prototype.delete=function(t){var e=this.cache.get(t);e&&(e.settled||e.aborter.abort(),this.cache.delete(t))},t.prototype.clear=function(){for(var t=this.cache.keys(),e=0,r=t.next();!r.done;r=t.next())this.delete(r.value),e+=1;return e},t}();e.default=o},1997:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1210),a=function(){},i=function(){function t(){this.signals=new Set,this.abortController=new n.AbortController}return t.prototype.addSignal=function(t){var e=this;if(void 0===t&&(t=new a),this.signal.aborted)throw new Error("cannot add a signal, already aborted!");this.signals.add(t),t.aborted?this.handleAborted(t):"function"===typeof t.addEventListener&&t.addEventListener("abort",(function(){e.handleAborted(t)}))},t.prototype.handleAborted=function(t){this.signals.delete(t),0===this.signals.size&&this.abortController.abort()},Object.defineProperty(t.prototype,"signal",{get:function(){return this.abortController.signal},enumerable:!0,configurable:!0}),t.prototype.abort=function(){this.abortController.abort()},t}();e.default=i},2001:function(t,e,r){t.exports=r(1213)},2004:function(t,e,r){t.exports=r(1214)},2007:function(t,e,r){t.exports=r(2008)},2008:function(t,e,r){r(2009);var n=r(123);t.exports=n.setTimeout},2009:function(t,e,r){var n=r(97),a=r(142),i=r(785),o=[].slice,u=function(t){return function(e,r){var n=arguments.length>2,a=n?o.call(arguments,2):void 0;return t(n?function(){("function"==typeof e?e:Function(e)).apply(this,a)}:e,r)}};n({global:!0,bind:!0,forced:/MSIE .\./.test(i)},{setTimeout:u(a.setTimeout),setInterval:u(a.setInterval)})},2010:function(t,e,r){t.exports=r(2011)},2011:function(t,e,r){var n=r(1170);t.exports=n},2012:function(t,e,r){t.exports=r(2013)},2013:function(t,e,r){var n=r(2014);r(2018),r(2019),r(2020),r(2021),t.exports=n},2014:function(t,e,r){r(582),r(2015),r(281);var n=r(123);t.exports=n.WeakMap},2015:function(t,e,r){"use strict";var n,a=r(142),i=r(586),o=r(589),u=r(1218),s=r(2017),f=r(162),c=r(250).enforce,l=r(1145),d=!a.ActiveXObject&&"ActiveXObject"in a,h=Object.isExtensible,p=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},v=t.exports=u("WeakMap",p,s);if(l&&d){n=s.getConstructor(p,"WeakMap",!0),o.REQUIRED=!0;var y=v.prototype,b=y.delete,x=y.has,m=y.get,g=y.set;i(y,{delete:function(t){if(f(t)&&!h(t)){var e=c(this);return e.frozen||(e.frozen=new n),b.call(this,t)||e.frozen.delete(t)}return b.call(this,t)},has:function(t){if(f(t)&&!h(t)){var e=c(this);return e.frozen||(e.frozen=new n),x.call(this,t)||e.frozen.has(t)}return x.call(this,t)},get:function(t){if(f(t)&&!h(t)){var e=c(this);return e.frozen||(e.frozen=new n),x.call(this,t)?m.call(this,t):e.frozen.get(t)}return m.call(this,t)},set:function(t,e){if(f(t)&&!h(t)){var r=c(this);r.frozen||(r.frozen=new n),x.call(this,t)?g.call(this,t,e):r.frozen.set(t,e)}else g.call(this,t,e);return this}})}},2017:function(t,e,r){"use strict";var n=r(586),a=r(589).getWeakData,i=r(122),o=r(162),u=r(587),s=r(145),f=r(319),c=r(194),l=r(250),d=l.set,h=l.getterFor,p=f.find,v=f.findIndex,y=0,b=function(t){return t.frozen||(t.frozen=new x)},x=function(){this.entries=[]},m=function(t,e){return p(t.entries,(function(t){return t[0]===e}))};x.prototype={get:function(t){var e=m(this,t);if(e)return e[1]},has:function(t){return!!m(this,t)},set:function(t,e){var r=m(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=v(this.entries,(function(e){return e[0]===t}));return~e&&this.entries.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,r,f){var l=t((function(t,n){u(t,l,e),d(t,{type:e,id:y++,frozen:void 0}),void 0!=n&&s(n,t[f],t,r)})),p=h(e),v=function(t,e,r){var n=p(t),o=a(i(e),!0);return!0===o?b(n).set(e,r):o[n.id]=r,t};return n(l.prototype,{delete:function(t){var e=p(this);if(!o(t))return!1;var r=a(t);return!0===r?b(e).delete(t):r&&c(r,e.id)&&delete r[e.id]},has:function(t){var e=p(this);if(!o(t))return!1;var r=a(t);return!0===r?b(e).has(t):r&&c(r,e.id)}}),n(l.prototype,r?{get:function(t){var e=p(this);if(o(t)){var r=a(t);return!0===r?b(e).get(t):r?r[e.id]:void 0}},set:function(t,e){return v(this,t,e)}}:{add:function(t){return v(this,t,!0)}}),l}}},2018:function(t,e,r){r(97)({target:"WeakMap",stat:!0},{from:r(1219)})},2019:function(t,e,r){r(97)({target:"WeakMap",stat:!0},{of:r(1220)})},2020:function(t,e,r){"use strict";var n=r(97),a=r(133),i=r(1221);n({target:"WeakMap",proto:!0,real:!0,forced:a},{deleteAll:function(){return i.apply(this,arguments)}})},2021:function(t,e,r){"use strict";r(97)({target:"WeakMap",proto:!0,real:!0,forced:r(133)},{upsert:r(802)})},2022:function(t,e,r){t.exports=r(1222)},2034:function(t,e,r){t.exports=r(1226)},2039:function(t,e,r){t.exports=r(1227)},2042:function(t,e,r){var n=r(1230),a=r(370),i=r(794),o=r(1231);function u(t){var e,r;function n(e,r){try{var u=t[e](r),s=u.value,f=s instanceof o;i.resolve(f?s.wrapped:s).then((function(t){f?n("return"===e?"return":"next",t):a(u.done?"return":"normal",t)}),(function(t){n("throw",t)}))}catch(c){a("throw",c)}}function a(t,a){switch(t){case"return":e.resolve({value:a,done:!0});break;case"throw":e.reject(a);break;default:e.resolve({value:a,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,a){return new i((function(i,o){var u={key:t,arg:a,resolve:i,reject:o,next:null};r?r=r.next=u:(e=r=u,n(t,a))}))},"function"!==typeof t.return&&(this.return=void 0)}"function"===typeof a&&n&&(u.prototype[n]=function(){return this}),u.prototype.next=function(t){return this._invoke("next",t)},u.prototype.throw=function(t){return this._invoke("throw",t)},u.prototype.return=function(t){return this._invoke("return",t)},t.exports=u},2043:function(t,e,r){var n=r(2044);t.exports=n},2044:function(t,e,r){r(1162);var n=r(583);t.exports=n.f("asyncIterator")},2045:function(t,e,r){t.exports=r(1237)},2050:function(t,e,r){t.exports=r(1238)},2054:function(t,e,r){"use strict";r(174)(e,"__esModule",{value:!0}),e.default=void 0;e.default={BAM_FPAIRED:1,BAM_FPROPER_PAIR:2,BAM_FUNMAP:4,BAM_FMUNMAP:8,BAM_FREVERSE:16,BAM_FMREVERSE:32,BAM_FREAD1:64,BAM_FREAD2:128,BAM_FSECONDARY:256,BAM_FQCFAIL:512,BAM_FDUP:1024,BAM_FSUPPLEMENTARY:2048}},2055:function(t,e,r){var n=r(1177),a=r(2056),i=r(1182),o=r(1187);t.exports=function(t){return n(t)||a(t)||i(t)||o()}},2056:function(t,e,r){var n=r(1183),a=r(1179),i=r(370);t.exports=function(t){if("undefined"!==typeof i&&a(Object(t)))return n(t)}},2057:function(t,e,r){"use strict";(function(t){var n=r(1217),a=r(221);r(174)(e,"__esModule",{value:!0}),e.default=void 0;var i=a(r(2058)),o=a(r(2066)),u=a(r(454)),s=a(r(801)),f=a(r(174)),c=a(r(788)),l=a(r(789)),d=a(r(790)),h=a(r(791)),p=a(r(584)),v=a(r(792)),y=a(r(320)),b=a(r(453)),x=a(r(371)),m=a(r(457)),g=a(r(373)),w=a(r(284)),k=a(r(285)),_=a(r(798)),E=a(r(795)),A=a(r(796)),S=a(r(799)),I=a(r(283)),C=a(r(372)),P=a(r(1229)),R=a(r(1232)),B=a(r(1234)),M=a(r(1233)),L=n(r(1225));r(2072);var T=r(321),F=r(1241);function O(t,e){var r=(0,p.default)(t);if(h.default){var n=(0,h.default)(t);e&&(n=(0,b.default)(n).call(n,(function(e){return(0,d.default)(t,e).enumerable}))),r.push.apply(r,n)}return r}function D(t){for(var e=1;e<arguments.length;e++){var r,n=null!=arguments[e]?arguments[e]:{};if(e%2)(0,y.default)(r=O(Object(n),!0)).call(r,(function(e){(0,I.default)(t,e,n[e])}));else if(l.default)(0,c.default)(t,(0,l.default)(n));else{var a;(0,y.default)(a=O(Object(n))).call(a,(function(e){(0,f.default)(t,e,(0,d.default)(n,e))}))}}return t}function U(t){var e=function(){if("undefined"===typeof Reflect||!v.default)return!1;if(v.default.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call((0,v.default)(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=(0,S.default)(t);if(e){var a=(0,S.default)(this).constructor;r=(0,v.default)(n,arguments,a)}else r=n.apply(this,arguments);return(0,A.default)(this,r)}}function z(t,e){return j.apply(this,arguments)}function j(){return(j=(0,C.default)(x.default.mark((function e(r,n){var a;return x.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.default.all((0,u.default)(r).call(r,function(){var e=(0,C.default)(x.default.mark((function e(r){var a,u,s,f;return x.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.url,u=r.headers,!(0,o.default)(a).call(a,"data:")){e.next=5;break}return e.abrupt("return",t.from(a.split(",")[1],"base64"));case 5:return u.referer,s=(0,i.default)(u,["referer"]),e.next=8,fetch(a,D(D({},n),{},{headers:D(D({},n.headers),s)}));case 8:if((f=e.sent).ok){e.next=11;break}throw new Error("Failed to fetch ".concat(f.statusText));case 11:return e.t0=t,e.next=14,f.arrayBuffer();case 14:return e.t1=e.sent,e.abrupt("return",e.t0.from.call(e.t0,e.t1));case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return a=e.sent,e.t0=(0,g.default)(t),e.t1=t,e.next=7,s.default.all((0,u.default)(a).call(a,(function(t){return(0,T.unzip)(t)})));case 7:return e.t2=e.sent,e.abrupt("return",e.t0.call.call(e.t0,e.t1,e.t2));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q=function(t){(0,E.default)(r,t);var e=U(r);function r(t){var n;return(0,w.default)(this,r),n=e.call(this,{bamFilehandle:"?",baiFilehandle:"?"}),(0,I.default)((0,_.default)(n),"baseUrl",void 0),(0,I.default)((0,_.default)(n),"trackId",void 0),n.baseUrl=t.baseUrl,n.trackId=t.trackId,n}return(0,k.default)(r,[{key:"streamRecordsForRange",value:function(t,e,r){var n=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{viewAsPairs:!1,pairAcrossChr:!1,maxInsertSize:2e5};return(0,P.default)(x.default.mark((function i(){var o,u,s,f,c,l,d,h,p,v,y,b;return x.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return l=(0,g.default)(o="".concat(n.baseUrl,"/")).call(o,n.trackId),d=(0,g.default)(u=(0,g.default)(s=(0,g.default)(f="".concat(l,"?referenceName=")).call(f,t,"&start=")).call(s,e,"&end=")).call(u,r,"&format=BAM"),h=n.chrToIndex&&n.chrToIndex[t],i.next=5,(0,R.default)(fetch(d,D({},a)));case 5:if((p=i.sent).ok){i.next=8;break}throw new Error(p.statusText);case 8:return i.next=10,(0,R.default)(p.json());case 10:return v=i.sent,i.next=13,(0,R.default)(z((0,m.default)(c=v.htsget.urls).call(c,1),a));case 13:return y=i.sent,b={buffer:y,chunk:{minv:{dataPosition:0}},toString:function(){var n,a;return(0,g.default)(n=(0,g.default)(a="".concat(t,"_")).call(a,e,"_")).call(n,r)}},i.delegateYield((0,M.default)((0,B.default)(n._fetchChunkFeatures([b],h,e,r,a)),R.default),"t0",16);case 16:case"end":return i.stop()}}),i)})))()}},{key:"_readChunk",value:function(){var t=(0,C.default)(x.default.mark((function t(e){var r,n,a;return x.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.chunk,n=r.buffer,a=r.chunk,t.abrupt("return",{data:n,cpositions:null,dpositions:null,chunk:a});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getHeader",value:function(){var t=(0,C.default)(x.default.mark((function t(){var e,r,n,a,i,o,u,s,f,c,l,d,h=arguments;return x.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=h.length>0&&void 0!==h[0]?h[0]:{},n=(0,g.default)(e="".concat(this.baseUrl,"/")).call(e,this.trackId,"?referenceName=na&class=header"),t.next=4,fetch(n,r);case 4:if((a=t.sent).ok){t.next=7;break}throw new Error("Failed to fetch ".concat(a.statusText));case 7:return t.next=9,a.json();case 9:return i=t.sent,t.next=12,z(i.htsget.urls,r);case 12:if((o=t.sent).readInt32LE(0)===L.BAM_MAGIC){t.next=15;break}throw new Error("Not a BAM file");case 15:return u=o.readInt32LE(4),s=o.toString("utf8",8,8+u),f=(0,F.parseHeaderText)(s),c=[],l={},d=(0,b.default)(f).call(f,(function(t){return"SQ"===t.tag})),(0,y.default)(d).call(d,(function(t,e){var r;(0,y.default)(r=t.data).call(r,(function(t){if("SN"===t.tag){var r=t.value;l[r]=e,c[e]=r}}))})),this.chrToIndex=l,this.indexToChr=c,t.abrupt("return",f);case 25:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),r}(L.default);e.default=q}).call(this,r(107).Buffer)},2058:function(t,e,r){var n=r(1242),a=r(2061),i=r(2063);t.exports=function(t,e){if(null==t)return{};var r,o,u=i(t,e);if(a){var s=a(t);for(o=0;o<s.length;o++)r=s[o],n(e).call(e,r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(u[r]=t[r])}return u}},2061:function(t,e,r){t.exports=r(2062)},2062:function(t,e,r){var n=r(1172);t.exports=n},2063:function(t,e,r){var n=r(1242),a=r(2064);t.exports=function(t,e){if(null==t)return{};var r,i,o={},u=a(t);for(i=0;i<u.length;i++)r=u[i],n(e).call(e,r)>=0||(o[r]=t[r]);return o}},2064:function(t,e,r){t.exports=r(2065)},2065:function(t,e,r){var n=r(1174);t.exports=n},2066:function(t,e,r){t.exports=r(2067)},2067:function(t,e,r){var n=r(2068);t.exports=n},2068:function(t,e,r){var n=r(2069),a=String.prototype;t.exports=function(t){var e=t.startsWith;return"string"===typeof t||t===a||t instanceof String&&e===a.startsWith?n:e}},2069:function(t,e,r){r(2070);var n=r(184);t.exports=n("String").startsWith},2070:function(t,e,r){"use strict";var n=r(97),a=r(366).f,i=r(251),o=r(1245),u=r(368),s=r(1246),f=r(133),c="".startsWith,l=Math.min,d=s("startsWith");n({target:"String",proto:!0,forced:!(!f&&!d&&!!function(){var t=a(String.prototype,"startsWith");return t&&!t.writable}())&&!d},{startsWith:function(t){var e=String(u(this));o(t);var r=i(l(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return c?c.call(e,n,r):e.slice(r,r+n.length)===n}})},2072:function(t,e){!function(t){!function(e){var r="URLSearchParams"in t,n="Symbol"in t&&"iterator"in Symbol,a="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),i="FormData"in t,o="ArrayBuffer"in t;if(o)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(t){return t&&u.indexOf(Object.prototype.toString.call(t))>-1};function f(t){if("string"!==typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function c(t){return"string"!==typeof t&&(t=String(t)),t}function l(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function d(t){this.map={},t instanceof d?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function h(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(t){return new Promise((function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}}))}function v(t){var e=new FileReader,r=p(e);return e.readAsArrayBuffer(t),r}function y(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"===typeof t?this._bodyText=t:a&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:i&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:r&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():o&&a&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=y(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o&&(ArrayBuffer.prototype.isPrototypeOf(t)||s(t))?this._bodyArrayBuffer=y(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"===typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var t=h(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var t=h(this);if(t)return t;if(this._bodyBlob)return function(t){var e=new FileReader,r=p(e);return e.readAsText(t),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(t,e){t=f(t),e=c(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},d.prototype.delete=function(t){delete this.map[f(t)]},d.prototype.get=function(t){return t=f(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(f(t))},d.prototype.set=function(t,e){this.map[f(t)]=c(e)},d.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},d.prototype.keys=function(){var t=[];return this.forEach((function(e,r){t.push(r)})),l(t)},d.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),l(t)},d.prototype.entries=function(){var t=[];return this.forEach((function(e,r){t.push([r,e])})),l(t)},n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var x=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function m(t,e){var r=(e=e||{}).body;if(t instanceof m){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new d(e.headers)),this.method=function(t){var e=t.toUpperCase();return x.indexOf(e)>-1?e:t}(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function g(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),a=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(a))}})),e}function w(t){var e=new d;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var r=t.split(":"),n=r.shift().trim();if(n){var a=r.join(":").trim();e.append(n,a)}})),e}function k(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new d(e.headers),this.url=e.url||"",this._initBody(t)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},b.call(m.prototype),b.call(k.prototype),k.prototype.clone=function(){return new k(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},k.error=function(){var t=new k(null,{status:0,statusText:""});return t.type="error",t};var _=[301,302,303,307,308];k.redirect=function(t,e){if(-1===_.indexOf(e))throw new RangeError("Invalid status code");return new k(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(A){e.DOMException=function(t,e){this.message=t,this.name=e;var r=Error(t);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function E(t,r){return new Promise((function(n,i){var o=new m(t,r);if(o.signal&&o.signal.aborted)return i(new e.DOMException("Aborted","AbortError"));var u=new XMLHttpRequest;function s(){u.abort()}u.onload=function(){var t={status:u.status,statusText:u.statusText,headers:w(u.getAllResponseHeaders()||"")};t.url="responseURL"in u?u.responseURL:t.headers.get("X-Request-URL");var e="response"in u?u.response:u.responseText;n(new k(e,t))},u.onerror=function(){i(new TypeError("Network request failed"))},u.ontimeout=function(){i(new TypeError("Network request failed"))},u.onabort=function(){i(new e.DOMException("Aborted","AbortError"))},u.open(o.method,o.url,!0),"include"===o.credentials?u.withCredentials=!0:"omit"===o.credentials&&(u.withCredentials=!1),"responseType"in u&&a&&(u.responseType="blob"),o.headers.forEach((function(t,e){u.setRequestHeader(e,t)})),o.signal&&(o.signal.addEventListener("abort",s),u.onreadystatechange=function(){4===u.readyState&&o.signal.removeEventListener("abort",s)}),u.send("undefined"===typeof o._bodyInit?null:o._bodyInit)}))}E.polyfill=!0,t.fetch||(t.fetch=E,t.Headers=d,t.Request=m,t.Response=k),e.Headers=d,e.Request=m,e.Response=k,e.fetch=E}({})}("undefined"!==typeof self?self:this)},221:function(t,e){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},283:function(t,e,r){var n=r(793);t.exports=function(t,e,r){return e in t?n(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},284:function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},285:function(t,e,r){var n=r(793);function a(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),n(t,a.key,a)}}t.exports=function(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),t}},320:function(t,e,r){t.exports=r(1169)},370:function(t,e,r){t.exports=r(1181)},371:function(t,e,r){t.exports=r(267)},372:function(t,e,r){var n=r(794);function a(t,e,r,a,i,o,u){try{var s=t[o](u),f=s.value}catch(c){return void r(c)}s.done?e(f):n.resolve(f).then(a,i)}t.exports=function(t){return function(){var e=this,r=arguments;return new n((function(n,i){var o=t.apply(e,r);function u(t){a(o,n,i,u,s,"next",t)}function s(t){a(o,n,i,u,s,"throw",t)}u(void 0)}))}}},373:function(t,e,r){t.exports=r(1206)},453:function(t,e,r){t.exports=r(1171)},454:function(t,e,r){t.exports=r(1189)},457:function(t,e,r){t.exports=r(1198)},584:function(t,e,r){t.exports=r(1173)},585:function(t,e,r){var n=r(1177),a=r(1962),i=r(1182),o=r(1187);t.exports=function(t,e){return n(t)||a(t,e)||i(t,e)||o()}},770:function(t,e,r){"use strict";var n=r(221),a=r(174);a(e,"__esModule",{value:!0}),a(e,"BAI",{enumerable:!0,get:function(){return i.default}}),a(e,"CSI",{enumerable:!0,get:function(){return o.default}}),a(e,"BamFile",{enumerable:!0,get:function(){return u.default}}),a(e,"HtsgetFile",{enumerable:!0,get:function(){return s.default}}),a(e,"BamRecord",{enumerable:!0,get:function(){return f.default}});var i=n(r(1143)),o=n(r(1216)),u=n(r(1225)),s=n(r(2057)),f=n(r(1236))},772:function(t,e,r){t.exports=r(1144)},783:function(t,e,r){t.exports=r(1921)},788:function(t,e,r){t.exports=r(1941)},789:function(t,e,r){t.exports=r(1944)},790:function(t,e,r){t.exports=r(1952)},791:function(t,e,r){t.exports=r(1957)},792:function(t,e,r){t.exports=r(1959)},793:function(t,e,r){t.exports=r(1188)},794:function(t,e,r){t.exports=r(1190)},795:function(t,e,r){var n=r(1984),a=r(1987);t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=n(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}},796:function(t,e,r){var n=r(1202),a=r(798);t.exports=function(t,e){return!e||"object"!==n(e)&&"function"!==typeof e?a(t):e}},797:function(t,e,r){t.exports=r(1203)},798:function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},799:function(t,e,r){var n=r(1991),a=r(1200);function i(e){return t.exports=i=a?n:function(t){return t.__proto__||n(t)},i(e)}t.exports=i},800:function(t,e,r){"use strict";var n=r(221);r(174)(e,"__esModule",{value:!0}),e.timeout=function(t){return new l.default((function(e){return(0,c.default)(e,t)}))},e.longToNumber=function(t){if(t.greaterThan(f.default)||t.lessThan(s.default))throw new Error("integer overflow");return t.toNumber()},e.checkAbortSignal=d,e.abortBreakPoint=function(t){return h.apply(this,arguments)},e.canMergeBlocks=p,e.makeOpts=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return"aborted"in t?{signal:t}:t},e.optimizeChunks=function(t,e){var r=[],n=null;if(0===t.length)return t;return(0,o.default)(t).call(t,(function(t,e){var r=t.minv.blockPosition-e.minv.blockPosition;return 0!==r?r:t.minv.dataPosition-e.minv.dataPosition})),(0,i.default)(t).call(t,(function(t){(!e||t.maxv.compareTo(e)>0)&&(null===n?(r.push(t),n=t):p(n,t)?t.maxv.compareTo(n.maxv)>0&&(n.maxv=t.maxv):(r.push(t),n=t))})),r};var a=n(r(371)),i=n(r(320)),o=n(r(1211)),u=n(r(372)),s=n(r(2001)),f=n(r(2004)),c=n(r(2007)),l=n(r(801));function d(t){if(t&&t.aborted){if("undefined"!==typeof DOMException)throw new DOMException("aborted","AbortError");var e=new Error("aborted");throw e.code="ERR_ABORTED",e}}function h(){return(h=(0,u.default)(a.default.mark((function t(e){return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.default.resolve();case 2:d(e);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function p(t,e){return e.minv.blockPosition-t.maxv.blockPosition<65e3&&e.maxv.blockPosition-t.minv.blockPosition<5e6}},801:function(t,e,r){t.exports=r(1215)}}]);
//# sourceMappingURL=6.56f5506c.chunk.js.map