{"version":3,"sources":["../../../plugins/data-management/src/AddConnectionWidget/components/ConfigureConnection.js","../../../plugins/data-management/src/AddConnectionWidget/components/ConnectionTypeSelect.tsx","../../../plugins/data-management/src/AddConnectionWidget/components/AddConnectionWidget.js"],"names":["observer","props","connectionType","model","setModelReady","ConfigEditorComponent","fallback","target","ConnectionTypeSelect","connectionTypeChoices","setConnectionType","useEffect","name","autoComplete","TextField","value","label","helperText","description","url","IconButton","href","rel","color","select","fullWidth","onChange","event","find","connectionTypeChoice","variant","map","MenuItem","key","displayName","useStyles","makeStyles","theme","root","marginTop","stepper","backgroundColor","default","button","marginRight","actionsContainer","marginBottom","steps","useState","configModel","setConfigModel","configModelReady","setConfigModelReady","activeStep","setActiveStep","classes","session","getSession","pluginManager","getEnv","newConnectionType","connectionId","Date","connectionConf","handleFinish","className","orientation","handleSetConnectionType","stepContent","disabled","onClick","data-testid"],"mappings":"8PAmBA,EAf4BA,oBAAS,SAAAC,GAAS,IACpCC,EAAyCD,EADL,eACpBE,EAAyBF,EADL,MACbG,EAAkBH,EADL,cAEtCI,EACJH,yBADF,IAGA,OACE,8BAAUI,SAAU,4CAClB,qBACEH,MAAO,CAAEI,OAAQJ,GACjBC,cAAeA,Q,gDCgERI,MArEf,SAA8BP,GAO3B,IACOQ,EAA6DR,EAA7DQ,sBAAuBP,EAAsCD,EAAtCC,eAAgBQ,EAAsBT,EAAtBS,kBAkB/C,OAhBAC,qBAAU,WACHT,EAAeU,MAClBF,EAAkBD,EAAsB,OAcvCP,EAAeU,KAIlB,0BAAMC,aAAa,OACjB,kBAACC,EAAA,EAAD,CACEC,MAAOb,EAAeU,KACtBI,MAAM,iBACNC,WACEf,EAAegB,YACb,oCACGhB,EAAegB,YACfhB,EAAeiB,IACd,kBAACC,EAAA,EAAD,CACEC,KAAMnB,EAAeiB,IACrBG,IAAI,sBACJf,OAAO,SACPgB,MAAM,aAEN,kBAAC,IAAD,OAEA,MAEJ,KAENC,QAAM,EACNC,WAAS,EACTC,SArCN,SACEC,GAEAjB,EACED,EAAsBmB,MACpB,SAACC,GAAD,OACEA,EAAqBjB,OAASe,EAAMpB,OAAOQ,WAgC7Ce,QAAQ,YAEPrB,EAAsBsB,KAAI,SAACF,GAAD,OACzB,kBAACG,EAAA,EAAD,CACEC,IAAKJ,EAAqBjB,KAC1BG,MAAOc,EAAqBjB,MAE3BiB,EAAqBK,aAAeL,EAAqBjB,WAlC3D,MCrBLuB,EAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCC,KAAM,CACJC,UAAWF,cAEbG,QAAS,CACPC,gBAAiBJ,qBAAyBK,SAE5CC,OAAQ,CACNJ,UAAWF,UADL,GAENO,YAAaP,cAEfQ,iBAAkB,CAChBC,aAAcT,kBAIZU,EAAQ,CAAC,2BAAf,wBAoHe/C,8BAlHf,SAA6B,GAAW,IAATG,EAAS,EAATA,MAAS,EACM6C,mBADN,uBAC/B9C,EAD+B,KACfQ,EADe,OAEAsC,mBAFA,uBAE/BC,EAF+B,KAElBC,EAFkB,OAGUF,oBAHV,sBAG/BG,EAH+B,KAGbC,EAHa,OAIFJ,mBAJE,sBAI/BK,EAJ+B,KAInBC,EAJmB,KAKhCC,EAAUpB,IAEVqB,EAAUC,qBAAhB,GAEQC,EAAkBC,iBATY,iBAWtC,cACEjD,KACAwC,EACEU,EAAA,oBAAsC,CACpCC,aAAc,GAAF,OAAKD,EAAL,iBAA+BE,KAA/B,UA+BlB,aACMT,IAAeN,SAAnB,EAQF,WACE,IAAMgB,EAAiBP,oBAAvB,GACAA,oBACAA,gBAXqCQ,GAChCV,EAAcD,EAAdC,GAGP,aACEA,EAAcD,EAAdC,GAmBF,OACE,yBAAKW,UAAWV,EAAQjB,MACtB,uBACE2B,UAAWV,EADb,QAEEF,WAFF,EAGEa,YAAY,YAEXnB,EAAA,KAAU,SAAA/B,GAAK,OACd,uBAAMiB,IAAKjB,GACT,2BADF,GAEE,2BA7DV,WACE,UACE,OACE,OACE,qBACEP,sBAAuBiD,yBADzB,cAIExD,eAJF,EAKEQ,kBAAmByD,IAGzB,OACE,OACE,qBACEjE,eADF,EAEEC,MAFF,EAGEC,cAAegD,IAIrB,QACE,OAAO,2BAAP,iBAwCOgB,GACD,yBAAKH,UAAWV,EAAQV,kBACtB,uBACEwB,SADF,IACYhB,EACViB,QAFF,EAGEL,UAAWV,EAAQZ,QAJvB,QAQE,uBACE0B,WA7BXhB,OAAoBnD,EAArB,MACCmD,UAFH,GA+BcvB,QAFF,YAGEP,MAHF,UAIE+C,QAJF,EAKEL,UAAWV,EALb,OAMEgB,cAAY,qBAEXlB,IAAeN,SAAfM,YArBK","file":"static/js/45.50e82a29.chunk.js","sourcesContent":["import React, { Suspense } from 'react'\nimport { ConfigurationEditor } from '@jbrowse/plugin-config'\nimport { observer } from 'mobx-react'\n\nconst ConfigureConnection = observer(props => {\n  const { connectionType, model, setModelReady } = props\n  const ConfigEditorComponent =\n    connectionType.configEditorComponent || ConfigurationEditor\n\n  return (\n    <Suspense fallback={<div>Loading...</div>}>\n      <ConfigEditorComponent\n        model={{ target: model }}\n        setModelReady={setModelReady}\n      />\n    </Suspense>\n  )\n})\n\nexport default ConfigureConnection\n","import IconButton from '@material-ui/core/IconButton'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport TextField from '@material-ui/core/TextField'\nimport React, { useEffect } from 'react'\nimport OpenInNewIcon from '@material-ui/icons/OpenInNew'\n\nimport ConnectionType from '@jbrowse/core/pluggableElementTypes/ConnectionType'\n\nfunction ConnectionTypeSelect(props: {\n  connectionTypeChoices: ConnectionType[]\n  connectionType: ConnectionType\n  setConnectionType: Function\n  assemblyNameChoices: string[]\n  assemblyName: string\n  setAssemblyName: Function\n}) {\n  const { connectionTypeChoices, connectionType, setConnectionType } = props\n\n  useEffect(() => {\n    if (!connectionType.name) {\n      setConnectionType(connectionTypeChoices[0])\n    }\n  })\n\n  function handleChange(\n    event: React.ChangeEvent<{ name?: string; value: unknown }>,\n  ): void {\n    setConnectionType(\n      connectionTypeChoices.find(\n        (connectionTypeChoice: ConnectionType) =>\n          connectionTypeChoice.name === event.target.value,\n      ),\n    )\n  }\n  if (!connectionType.name) {\n    return null\n  }\n  return (\n    <form autoComplete=\"off\">\n      <TextField\n        value={connectionType.name}\n        label=\"connectionType\"\n        helperText={\n          connectionType.description ? (\n            <>\n              {connectionType.description}\n              {connectionType.url ? (\n                <IconButton\n                  href={connectionType.url}\n                  rel=\"noopener noreferrer\"\n                  target=\"_blank\"\n                  color=\"secondary\"\n                >\n                  <OpenInNewIcon />\n                </IconButton>\n              ) : null}\n            </>\n          ) : null\n        }\n        select\n        fullWidth\n        onChange={handleChange}\n        variant=\"outlined\"\n      >\n        {connectionTypeChoices.map((connectionTypeChoice: ConnectionType) => (\n          <MenuItem\n            key={connectionTypeChoice.name}\n            value={connectionTypeChoice.name}\n          >\n            {connectionTypeChoice.displayName || connectionTypeChoice.name}\n          </MenuItem>\n        ))}\n      </TextField>\n    </form>\n  )\n}\n\nexport default ConnectionTypeSelect\n","import { getSession } from '@jbrowse/core/util'\nimport Button from '@material-ui/core/Button'\nimport Step from '@material-ui/core/Step'\nimport StepContent from '@material-ui/core/StepContent'\nimport StepLabel from '@material-ui/core/StepLabel'\nimport Stepper from '@material-ui/core/Stepper'\nimport { makeStyles } from '@material-ui/core/styles'\nimport Typography from '@material-ui/core/Typography'\nimport { observer, PropTypes as MobxPropTypes } from 'mobx-react'\nimport { getEnv } from 'mobx-state-tree'\nimport React, { useState } from 'react'\nimport ConfigureConnection from './ConfigureConnection'\nimport ConnectionTypeSelect from './ConnectionTypeSelect'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    marginTop: theme.spacing(1),\n  },\n  stepper: {\n    backgroundColor: theme.palette.background.default,\n  },\n  button: {\n    marginTop: theme.spacing(1),\n    marginRight: theme.spacing(1),\n  },\n  actionsContainer: {\n    marginBottom: theme.spacing(2),\n  },\n}))\n\nconst steps = ['Select a Connection Type', 'Configure Connection']\n\nfunction AddConnectionWidget({ model }) {\n  const [connectionType, setConnectionType] = useState({})\n  const [configModel, setConfigModel] = useState({})\n  const [configModelReady, setConfigModelReady] = useState(true)\n  const [activeStep, setActiveStep] = useState(0)\n  const classes = useStyles()\n\n  const session = getSession(model)\n\n  const { pluginManager } = getEnv(session)\n\n  function handleSetConnectionType(newConnectionType) {\n    setConnectionType(newConnectionType)\n    setConfigModel(\n      newConnectionType.configSchema.create({\n        connectionId: `${newConnectionType.name}-${Date.now()}`,\n      }),\n    )\n  }\n\n  function stepContent() {\n    switch (activeStep) {\n      case 0:\n        return (\n          <ConnectionTypeSelect\n            connectionTypeChoices={pluginManager.getElementTypesInGroup(\n              'connection',\n            )}\n            connectionType={connectionType}\n            setConnectionType={handleSetConnectionType}\n          />\n        )\n      case 1:\n        return (\n          <ConfigureConnection\n            connectionType={connectionType}\n            model={configModel}\n            setModelReady={setConfigModelReady}\n          />\n        )\n\n      default:\n        return <Typography>Unknown step</Typography>\n    }\n  }\n\n  function handleNext() {\n    if (activeStep === steps.length - 1) handleFinish()\n    else setActiveStep(activeStep + 1)\n  }\n\n  function handleBack() {\n    setActiveStep(activeStep - 1)\n  }\n\n  function handleFinish() {\n    const connectionConf = session.addConnectionConf(configModel)\n    session.makeConnection(connectionConf)\n    session.hideWidget(model)\n  }\n\n  function checkNextEnabled() {\n    if (\n      (activeStep === 0 && connectionType.name) ||\n      (activeStep === 1 && configModel && configModelReady)\n    ) {\n      return true\n    }\n    return false\n  }\n\n  return (\n    <div className={classes.root}>\n      <Stepper\n        className={classes.stepper}\n        activeStep={activeStep}\n        orientation=\"vertical\"\n      >\n        {steps.map(label => (\n          <Step key={label}>\n            <StepLabel>{label}</StepLabel>\n            <StepContent>\n              {stepContent()}\n              <div className={classes.actionsContainer}>\n                <Button\n                  disabled={activeStep === 0}\n                  onClick={handleBack}\n                  className={classes.button}\n                >\n                  Back\n                </Button>\n                <Button\n                  disabled={!checkNextEnabled()}\n                  variant=\"contained\"\n                  color=\"primary\"\n                  onClick={handleNext}\n                  className={classes.button}\n                  data-testid=\"addConnectionNext\"\n                >\n                  {activeStep === steps.length - 1 ? 'Connect' : 'Next'}\n                </Button>\n              </div>\n            </StepContent>\n          </Step>\n        ))}\n      </Stepper>\n    </div>\n  )\n}\n\nAddConnectionWidget.propTypes = {\n  model: MobxPropTypes.observableObject.isRequired,\n}\n\nexport default observer(AddConnectionWidget)\n"],"sourceRoot":""}